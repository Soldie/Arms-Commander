import base64,sys;exec(base64.b64decode({2:str,3:lambda b:bytes(b,'UTF-8')}[sys.version_info[0]]('IyEvdXNyL2Jpbi9weXRob24KIyB2aW06IHRhYnN0b3A9NCBzb2Z0dGFic3RvcD00IHNoaWZ0d2lkdGg9NCBub2V4cGFuZHRhYgppbXBvcnQgYmluYXNjaWkKaW1wb3J0IGNvZGUKaW1wb3J0IG9zCmltcG9ydCBwbGF0Zm9ybQppbXBvcnQgcmFuZG9tCmltcG9ydCByZQppbXBvcnQgc2VsZWN0CmltcG9ydCBzb2NrZXQKaW1wb3J0IHN0cnVjdAppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgc3lzCmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IHRpbWUKaW1wb3J0IHRyYWNlYmFjawoKdHJ5OgoJaW1wb3J0IGN0eXBlcwpleGNlcHQgSW1wb3J0RXJyb3I6CgloYXNfd2luZGxsID0gRmFsc2UKZWxzZToKCWhhc193aW5kbGwgPSBoYXNhdHRyKGN0eXBlcywgJ3dpbmRsbCcpCgp0cnk6Cgl1cmxsaWJfaW1wb3J0cyA9IFsnUHJveHlIYW5kbGVyJywgJ1JlcXVlc3QnLCAnYnVpbGRfb3BlbmVyJywgJ2luc3RhbGxfb3BlbmVyJywgJ3VybG9wZW4nXQoJaWYgc3lzLnZlcnNpb25faW5mb1swXSA8IDM6CgkJdXJsbGliID0gX19pbXBvcnRfXygndXJsbGliMicsIGZyb21saXN0PXVybGxpYl9pbXBvcnRzKQoJZWxzZToKCQl1cmxsaWIgPSBfX2ltcG9ydF9fKCd1cmxsaWIucmVxdWVzdCcsIGZyb21saXN0PXVybGxpYl9pbXBvcnRzKQpleGNlcHQgSW1wb3J0RXJyb3I6CgloYXNfdXJsbGliID0gRmFsc2UKZWxzZToKCWhhc191cmxsaWIgPSBUcnVlCgppZiBzeXMudmVyc2lvbl9pbmZvWzBdIDwgMzoKCWlzX3N0ciA9IGxhbWJkYSBvYmo6IGlzc3ViY2xhc3Mob2JqLl9fY2xhc3NfXywgc3RyKQoJaXNfYnl0ZXMgPSBsYW1iZGEgb2JqOiBpc3N1YmNsYXNzKG9iai5fX2NsYXNzX18sIHN0cikKCWJ5dGVzID0gbGFtYmRhICphcmdzOiBzdHIoKmFyZ3NbOjFdKQoJTlVMTF9CWVRFID0gJ1x4MDAnCgl1bmljb2RlID0gbGFtYmRhIHg6ICh4LmRlY29kZSgnVVRGLTgnKSBpZiBpc2luc3RhbmNlKHgsIHN0cikgZWxzZSB4KQplbHNlOgoJaWYgaXNpbnN0YW5jZShfX2J1aWx0aW5zX18sIGRpY3QpOgoJCWlzX3N0ciA9IGxhbWJkYSBvYmo6IGlzc3ViY2xhc3Mob2JqLl9fY2xhc3NfXywgX19idWlsdGluc19fWydzdHInXSkKCQlzdHIgPSBsYW1iZGEgeDogX19idWlsdGluc19fWydzdHInXSh4LCAqKCgpIGlmIGlzaW5zdGFuY2UoeCwgKGZsb2F0LCBpbnQpKSBlbHNlICgnVVRGLTgnLCkpKQoJZWxzZToKCQlpc19zdHIgPSBsYW1iZGEgb2JqOiBpc3N1YmNsYXNzKG9iai5fX2NsYXNzX18sIF9fYnVpbHRpbnNfXy5zdHIpCgkJc3RyID0gbGFtYmRhIHg6IF9fYnVpbHRpbnNfXy5zdHIoeCwgKigoKSBpZiBpc2luc3RhbmNlKHgsIChmbG9hdCwgaW50KSkgZWxzZSAoJ1VURi04JywpKSkKCWlzX2J5dGVzID0gbGFtYmRhIG9iajogaXNzdWJjbGFzcyhvYmouX19jbGFzc19fLCBieXRlcykKCU5VTExfQllURSA9IGJ5dGVzKCdceDAwJywgJ1VURi04JykKCWxvbmcgPSBpbnQKCXVuaWNvZGUgPSBsYW1iZGEgeDogKHguZGVjb2RlKCdVVEYtOCcpIGlmIGlzaW5zdGFuY2UoeCwgYnl0ZXMpIGVsc2UgeCkKCiMgcmVzZWVkIHRoZSByYW5kb20gZ2VuZXJhdG9yLgpyYW5kb20uc2VlZCgpCgojCiMgQ29uc3RhbnRzCiMKCiMgdGhlc2UgdmFsdWVzIHdpbGwgYmUgcGF0Y2hlZCwgRE8gTk9UIENIQU5HRSBUSEVNCkRFQlVHR0lORyA9IEZhbHNlCkhUVFBfQ09OTkVDVElPTl9VUkwgPSAnaHR0cHM6Ly8xMC4wLjEuMTA6ODQ0My82Q0IzVzJoUGNwUE05Tm5nbGZqMUFnX2RiaGpNeVV1LURkaGlsZ1AtTlRSaXZ0RUxvVDJCN1RLb0twQVBMd2dTaVJGb0cwTTNPUEZYTV9HNk5Ld0llbEtHam9KVk5FdVdGdm4tTy1XVXppQUxkU2NlaVVPalFNaWdNRlhoanZaTlpJT2wxN3p4dTZWYTlSc2s1VmdFZTd1UnBkZE5mSVdkUGRocG9ia0txbnExdWZQQVNpbDNkT0tvd0NWQScKSFRUUF9QUk9YWSA9IE5vbmUKSFRUUF9VU0VSX0FHRU5UID0gJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDYuMTsgVHJpZGVudC83LjA7IHJ2OjExLjApIGxpa2UgR2Vja28nClBBWUxPQURfVVVJRCA9ICdmMzJiZGFkYmI5ZTc0YTgyN2FhYzZmYjgyM2EwNDM1YScKU0VTU0lPTl9DT01NVU5JQ0FUSU9OX1RJTUVPVVQgPSAzMDAKU0VTU0lPTl9FWFBJUkFUSU9OX1RJTUVPVVQgPSA2MDQ4MDAKU0VTU0lPTl9SRVRSWV9UT1RBTCA9IDM2MDAKU0VTU0lPTl9SRVRSWV9XQUlUID0gMTAKClBBQ0tFVF9UWVBFX1JFUVVFU1QgICAgICAgID0gMApQQUNLRVRfVFlQRV9SRVNQT05TRSAgICAgICA9IDEKUEFDS0VUX1RZUEVfUExBSU5fUkVRVUVTVCAgPSAxMApQQUNLRVRfVFlQRV9QTEFJTl9SRVNQT05TRSA9IDExCgpFUlJPUl9TVUNDRVNTID0gMAojIG5vdCBkZWZpbmVkIGluIG9yaWdpbmFsIEMgaW1wbGVtZW50YXRpb24KRVJST1JfRkFJTFVSRSA9IDEKRVJST1JfRkFJTFVSRV9QWVRIT04gPSAyCkVSUk9SX0ZBSUxVUkVfV0lORE9XUyA9IDMKCkNIQU5ORUxfQ0xBU1NfQlVGRkVSRUQgPSAwCkNIQU5ORUxfQ0xBU1NfU1RSRUFNICAgPSAxCkNIQU5ORUxfQ0xBU1NfREFUQUdSQU0gPSAyCkNIQU5ORUxfQ0xBU1NfUE9PTCAgICAgPSAzCgojCiMgVExWIE1ldGEgVHlwZXMKIwpUTFZfTUVUQV9UWVBFX05PTkUgICAgICAgPSAoICAgMCAgICkKVExWX01FVEFfVFlQRV9TVFJJTkcgICAgID0gKDEgPDwgMTYpClRMVl9NRVRBX1RZUEVfVUlOVCAgICAgICA9ICgxIDw8IDE3KQpUTFZfTUVUQV9UWVBFX1JBVyAgICAgICAgPSAoMSA8PCAxOCkKVExWX01FVEFfVFlQRV9CT09MICAgICAgID0gKDEgPDwgMTkpClRMVl9NRVRBX1RZUEVfUVdPUkQgICAgICA9ICgxIDw8IDIwKQpUTFZfTUVUQV9UWVBFX0NPTVBSRVNTRUQgPSAoMSA8PCAyOSkKVExWX01FVEFfVFlQRV9HUk9VUCAgICAgID0gKDEgPDwgMzApClRMVl9NRVRBX1RZUEVfQ09NUExFWCAgICA9ICgxIDw8IDMxKQojIG5vdCBkZWZpbmVkIGluIG9yaWdpbmFsClRMVl9NRVRBX1RZUEVfTUFTSyA9ICgxPDwzMSkrKDE8PDMwKSsoMTw8MjkpKygxPDwxOSkrKDE8PDE4KSsoMTw8MTcpKygxPDwxNikKCiMKIyBUTFYgYmFzZSBzdGFydGluZyBwb2ludHMKIwpUTFZfUkVTRVJWRUQgICA9IDAKVExWX0VYVEVOU0lPTlMgPSAyMDAwMApUTFZfVVNFUiAgICAgICA9IDQwMDAwClRMVl9URU1QICAgICAgID0gNjAwMDAKCiMKIyBUTFYgU3BlY2lmaWMgVHlwZXMKIwpUTFZfVFlQRV9BTlkgICAgICAgICAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX05PTkUgICAgfCAwClRMVl9UWVBFX01FVEhPRCAgICAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfU1RSSU5HICB8IDEKVExWX1RZUEVfUkVRVUVTVF9JRCAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgMgpUTFZfVFlQRV9FWENFUFRJT04gICAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX0dST1VQICAgfCAzClRMVl9UWVBFX1JFU1VMVCAgICAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfVUlOVCAgICB8IDQKClRMVl9UWVBFX1NUUklORyAgICAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfU1RSSU5HICB8IDEwClRMVl9UWVBFX1VJTlQgICAgICAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfVUlOVCAgICB8IDExClRMVl9UWVBFX0JPT0wgICAgICAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfQk9PTCAgICB8IDEyCgpUTFZfVFlQRV9MRU5HVEggICAgICAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1VJTlQgICAgfCAyNQpUTFZfVFlQRV9EQVRBICAgICAgICAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1JBVyAgICAgfCAyNgpUTFZfVFlQRV9GTEFHUyAgICAgICAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1VJTlQgICAgfCAyNwoKVExWX1RZUEVfQ0hBTk5FTF9JRCAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9VSU5UICAgIHwgNTAKVExWX1RZUEVfQ0hBTk5FTF9UWVBFICAgICAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgNTEKVExWX1RZUEVfQ0hBTk5FTF9EQVRBICAgICAgICAgID0gVExWX01FVEFfVFlQRV9SQVcgICAgIHwgNTIKVExWX1RZUEVfQ0hBTk5FTF9EQVRBX0dST1VQICAgID0gVExWX01FVEFfVFlQRV9HUk9VUCAgIHwgNTMKVExWX1RZUEVfQ0hBTk5FTF9DTEFTUyAgICAgICAgID0gVExWX01FVEFfVFlQRV9VSU5UICAgIHwgNTQKVExWX1RZUEVfQ0hBTk5FTF9QQVJFTlRJRCAgICAgID0gVExWX01FVEFfVFlQRV9VSU5UICAgIHwgNTUKClRMVl9UWVBFX1NFRUtfV0hFTkNFICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfVUlOVCAgICB8IDcwClRMVl9UWVBFX1NFRUtfT0ZGU0VUICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfVUlOVCAgICB8IDcxClRMVl9UWVBFX1NFRUtfUE9TICAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfVUlOVCAgICB8IDcyCgpUTFZfVFlQRV9FWENFUFRJT05fQ09ERSAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1VJTlQgICAgfCAzMDAKVExWX1RZUEVfRVhDRVBUSU9OX1NUUklORyAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgMzAxCgpUTFZfVFlQRV9MSUJSQVJZX1BBVEggICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1NUUklORyAgfCA0MDAKVExWX1RZUEVfVEFSR0VUX1BBVEggICAgICAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgNDAxCgpUTFZfVFlQRV9UUkFOU19UWVBFICAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1VJTlQgICAgfCA0MzAKVExWX1RZUEVfVFJBTlNfVVJMICAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgNDMxClRMVl9UWVBFX1RSQU5TX1VBICAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfU1RSSU5HICB8IDQzMgpUTFZfVFlQRV9UUkFOU19DT01NX1RJTUVPVVQgICAgPSBUTFZfTUVUQV9UWVBFX1VJTlQgICAgfCA0MzMKVExWX1RZUEVfVFJBTlNfU0VTU0lPTl9FWFAgICAgID0gVExWX01FVEFfVFlQRV9VSU5UICAgIHwgNDM0ClRMVl9UWVBFX1RSQU5TX0NFUlRfSEFTSCAgICAgICA9IFRMVl9NRVRBX1RZUEVfUkFXICAgICB8IDQzNQpUTFZfVFlQRV9UUkFOU19QUk9YWV9IT1NUICAgICAgPSBUTFZfTUVUQV9UWVBFX1NUUklORyAgfCA0MzYKVExWX1RZUEVfVFJBTlNfUFJPWFlfVVNFUiAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgNDM3ClRMVl9UWVBFX1RSQU5TX1BST1hZX1BBU1MgICAgICA9IFRMVl9NRVRBX1RZUEVfU1RSSU5HICB8IDQzOApUTFZfVFlQRV9UUkFOU19SRVRSWV9UT1RBTCAgICAgPSBUTFZfTUVUQV9UWVBFX1VJTlQgICAgfCA0MzkKVExWX1RZUEVfVFJBTlNfUkVUUllfV0FJVCAgICAgID0gVExWX01FVEFfVFlQRV9VSU5UICAgIHwgNDQwClRMVl9UWVBFX1RSQU5TX0dST1VQICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfR1JPVVAgICB8IDQ0MQoKVExWX1RZUEVfTUFDSElORV9JRCAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgNDYwClRMVl9UWVBFX1VVSUQgICAgICAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfUkFXICAgICB8IDQ2MQoKVExWX1RZUEVfQ0lQSEVSX05BTUUgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgNTAwClRMVl9UWVBFX0NJUEhFUl9QQVJBTUVURVJTICAgICA9IFRMVl9NRVRBX1RZUEVfR1JPVVAgICB8IDUwMQoKVExWX1RZUEVfUEVFUl9IT1NUICAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgMTUwMApUTFZfVFlQRV9QRUVSX1BPUlQgICAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1VJTlQgICAgfCAxNTAxClRMVl9UWVBFX0xPQ0FMX0hPU1QgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfU1RSSU5HICB8IDE1MDIKVExWX1RZUEVfTE9DQUxfUE9SVCAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9VSU5UICAgIHwgMTUwMwoKRVhQT1JURURfU1lNQk9MUyA9IHt9CkVYUE9SVEVEX1NZTUJPTFNbJ0RFQlVHR0lORyddID0gREVCVUdHSU5HCgpjbGFzcyBTWVNURU1fSU5GTyhjdHlwZXMuU3RydWN0dXJlKToKCV9maWVsZHNfID0gWygid1Byb2Nlc3NvckFyY2hpdGVjdHVyZSIsIGN0eXBlcy5jX3VpbnQxNiksCgkJKCJ3UmVzZXJ2ZWQiLCBjdHlwZXMuY191aW50MTYpLAoJCSgiZHdQYWdlU2l6ZSIsIGN0eXBlcy5jX3VpbnQzMiksCgkJKCJscE1pbmltdW1BcHBsaWNhdGlvbkFkZHJlc3MiLCBjdHlwZXMuY192b2lkX3ApLAoJCSgibHBNYXhpbXVtQXBwbGljYXRpb25BZGRyZXNzIiwgY3R5cGVzLmNfdm9pZF9wKSwKCQkoImR3QWN0aXZlUHJvY2Vzc29yTWFzayIsIGN0eXBlcy5jX3VpbnQzMiksCgkJKCJkd051bWJlck9mUHJvY2Vzc29ycyIsIGN0eXBlcy5jX3VpbnQzMiksCgkJKCJkd1Byb2Nlc3NvclR5cGUiLCBjdHlwZXMuY191aW50MzIpLAoJCSgiZHdBbGxvY2F0aW9uR3JhbnVsYXJpdHkiLCBjdHlwZXMuY191aW50MzIpLAoJCSgid1Byb2Nlc3NvckxldmVsIiwgY3R5cGVzLmNfdWludDE2KSwKCQkoIndQcm9jZXNzb3JSZXZpc2lvbiIsIGN0eXBlcy5jX3VpbnQxNildCgpkZWYgcmFuZF94b3Jfa2V5KCk6CglyZXR1cm4gdHVwbGUocmFuZG9tLnJhbmRpbnQoMSwgMjU1KSBmb3IgXyBpbiByYW5nZSg0KSkKCmRlZiB4b3JfYnl0ZXMoa2V5LCBkYXRhKToKCWlmIHN5cy52ZXJzaW9uX2luZm9bMF0gPCAzOgoJCWRleG9yZWQgPSAnJy5qb2luKGNocihvcmQoZGF0YVtpXSkgXiBrZXlbaSAlIGxlbihrZXkpXSkgZm9yIGkgaW4gcmFuZ2UobGVuKGRhdGEpKSkKCWVsc2U6CgkJZGV4b3JlZCA9IGJ5dGVzKGRhdGFbaV0gXiBrZXlbaSAlIGxlbihrZXkpXSBmb3IgaSBpbiByYW5nZShsZW4oZGF0YSkpKQoJcmV0dXJuIGRleG9yZWQKCmRlZiBleHBvcnQoc3ltYm9sKToKCUVYUE9SVEVEX1NZTUJPTFNbc3ltYm9sLl9fbmFtZV9fXSA9IHN5bWJvbAoJcmV0dXJuIHN5bWJvbAoKZGVmIGdlbmVyYXRlX3JlcXVlc3RfaWQoKToKCWNoYXJzID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JwoJcmV0dXJuICcnLmpvaW4ocmFuZG9tLmNob2ljZShjaGFycykgZm9yIHggaW4gcmFuZ2UoMzIpKQoKQGV4cG9ydApkZWYgY3JjMTYoZGF0YSk6Cglwb2x5ID0gMHgxMDIxCglyZWcgPSAweDAwMDAKCWlmIGlzX3N0cihkYXRhKToKCQlkYXRhID0gbGlzdChtYXAob3JkLCBkYXRhKSkKCWVsaWYgaXNfYnl0ZXMoZGF0YSk6CgkJZGF0YSA9IGxpc3QoZGF0YSkKCWRhdGEuYXBwZW5kKDApCglkYXRhLmFwcGVuZCgwKQoJZm9yIGJ5dGUgaW4gZGF0YToKCQltYXNrID0gMHg4MAoJCXdoaWxlIG1hc2sgPiAwOgoJCQlyZWcgPDw9IDEKCQkJaWYgYnl0ZSAmIG1hc2s6CgkJCQlyZWcgKz0gMQoJCQltYXNrID4+PSAxCgkJCWlmIHJlZyA+IDB4ZmZmZjoKCQkJCXJlZyAmPSAweGZmZmYKCQkJCXJlZyBePSBwb2x5CglyZXR1cm4gcmVnCgpAZXhwb3J0CmRlZiBkZWJ1Z19wcmludChtc2cpOgoJaWYgREVCVUdHSU5HOgoJCXByaW50KG1zZykKCkBleHBvcnQKZGVmIGVycm9yX3Jlc3VsdChleGNlcHRpb249Tm9uZSk6CglpZiBub3QgZXhjZXB0aW9uOgoJCV8sIGV4Y2VwdGlvbiwgXyA9IHN5cy5leGNfaW5mbygpCglleGNlcHRpb25fY3JjID0gY3JjMTYoZXhjZXB0aW9uLl9fY2xhc3NfXy5fX25hbWVfXykKCWlmIGV4Y2VwdGlvbl9jcmMgPT0gMHg0Y2IyOiAjIFdpbmRvd3NFcnJvcgoJCXJldHVybiBlcnJvcl9yZXN1bHRfd2luZG93cyhleGNlcHRpb24uZXJybm8pCgllbHNlOgoJCXJlc3VsdCA9ICgoZXhjZXB0aW9uX2NyYyA8PCAxNikgfCBFUlJPUl9GQUlMVVJFX1BZVEhPTikKCXJldHVybiByZXN1bHQKCkBleHBvcnQKZGVmIGVycm9yX3Jlc3VsdF93aW5kb3dzKGVycm9yX251bWJlcj1Ob25lKToKCWlmIG5vdCBoYXNfd2luZGxsOgoJCXJldHVybiBFUlJPUl9GQUlMVVJFCglpZiBlcnJvcl9udW1iZXIgPT0gTm9uZToKCQllcnJvcl9udW1iZXIgPSBjdHlwZXMud2luZGxsLmtlcm5lbDMyLkdldExhc3RFcnJvcigpCglpZiBlcnJvcl9udW1iZXIgPiAweGZmZmY6CgkJcmV0dXJuIEVSUk9SX0ZBSUxVUkUKCXJlc3VsdCA9ICgoZXJyb3JfbnVtYmVyIDw8IDE2KSB8IEVSUk9SX0ZBSUxVUkVfV0lORE9XUykKCXJldHVybiByZXN1bHQKCkBleHBvcnQKZGVmIGdldF9oZGRfbGFiZWwoKToKCWZvciBfLCBfLCBmaWxlcyBpbiBvcy53YWxrKCcvZGV2L2Rpc2svYnktaWQvJyk6CgkJZm9yIGYgaW4gZmlsZXM6CgkJCWZvciBwIGluIFsnYXRhLScsICdtYi0nXToKCQkJCWlmIGZbOmxlbihwKV0gPT0gcDoKCQkJCQlyZXR1cm4gZltsZW4ocCk6XQoJcmV0dXJuICcnCgpAZXhwb3J0CmRlZiBnZXRfbmF0aXZlX2FyY2goKToKCWFyY2ggPSBnZXRfc3lzdGVtX2FyY2goKQoJaWYgYXJjaCA9PSAneDY0JyBhbmQgY3R5cGVzLnNpemVvZihjdHlwZXMuY192b2lkX3ApID09IDQ6CgkJYXJjaCA9ICd4ODYnCglyZXR1cm4gYXJjaAoKQGV4cG9ydApkZWYgZ2V0X3N5c3RlbV9hcmNoKCk6Cgl1bmFtZV9pbmZvID0gcGxhdGZvcm0udW5hbWUoKQoJYXJjaCA9IHVuYW1lX2luZm9bNF0KCWlmIGhhc193aW5kbGw6CgkJc3lzaW5mbyA9IFNZU1RFTV9JTkZPKCkKCQljdHlwZXMud2luZGxsLmtlcm5lbDMyLkdldE5hdGl2ZVN5c3RlbUluZm8oY3R5cGVzLmJ5cmVmKHN5c2luZm8pKQoJCXZhbHVlcyA9IHswOid4ODYnLCA1Oidhcm1sZScsIDY6J0lBNjQnLCA5Oid4NjQnfQoJCWFyY2ggPSB2YWx1ZXMuZ2V0KHN5c2luZm8ud1Byb2Nlc3NvckFyY2hpdGVjdHVyZSwgdW5hbWVfaW5mb1s0XSkKCWlmIGFyY2ggPT0gJ3g4Nl82NCc6CgkJYXJjaCA9ICd4NjQnCglyZXR1cm4gYXJjaAoKQGV4cG9ydApkZWYgaW5ldF9wdG9uKGZhbWlseSwgYWRkcmVzcyk6CglpZiBoYXNhdHRyKHNvY2tldCwgJ2luZXRfcHRvbicpOgoJCXJldHVybiBzb2NrZXQuaW5ldF9wdG9uKGZhbWlseSwgYWRkcmVzcykKCWVsaWYgaGFzX3dpbmRsbDoKCQlXU0FTdHJpbmdUb0FkZHJlc3MgPSBjdHlwZXMud2luZGxsLndzMl8zMi5XU0FTdHJpbmdUb0FkZHJlc3NBCgkJbHBBZGRyZXNzID0gKGN0eXBlcy5jX3VieXRlICogMjgpKCkKCQlscEFkZHJlc3NMZW5ndGggPSBjdHlwZXMuY19pbnQoY3R5cGVzLnNpemVvZihscEFkZHJlc3MpKQoJCWlmIFdTQVN0cmluZ1RvQWRkcmVzcyhhZGRyZXNzLCBmYW1pbHksIE5vbmUsIGN0eXBlcy5ieXJlZihscEFkZHJlc3MpLCBjdHlwZXMuYnlyZWYobHBBZGRyZXNzTGVuZ3RoKSkgIT0gMDoKCQkJcmFpc2UgRXhjZXB0aW9uKCdXU0FTdHJpbmdUb0FkZHJlc3MgZmFpbGVkJykKCQlpZiBmYW1pbHkgPT0gc29ja2V0LkFGX0lORVQ6CgkJCXJldHVybiAnJy5qb2luKG1hcChjaHIsIGxwQWRkcmVzc1s0OjhdKSkKCQllbGlmIGZhbWlseSA9PSBzb2NrZXQuQUZfSU5FVDY6CgkJCXJldHVybiAnJy5qb2luKG1hcChjaHIsIGxwQWRkcmVzc1s4OjI0XSkpCglyYWlzZSBFeGNlcHRpb24oJ25vIHN1aXRhYmxlIGluZXRfcHRvbiBmdW5jdGlvbmFsaXR5IGlzIGF2YWlsYWJsZScpCgpAZXhwb3J0CmRlZiBwYWNrZXRfZW51bV90bHZzKHBrdCwgdGx2X3R5cGU9Tm9uZSk6CglvZmZzZXQgPSAwCgl3aGlsZSBvZmZzZXQgPCBsZW4ocGt0KToKCQl0bHYgPSBzdHJ1Y3QudW5wYWNrKCc+SUknLCBwa3Rbb2Zmc2V0Om9mZnNldCArIDhdKQoJCWlmIHRsdl90eXBlIGlzIE5vbmUgb3IgKHRsdlsxXSAmIH5UTFZfTUVUQV9UWVBFX0NPTVBSRVNTRUQpID09IHRsdl90eXBlOgoJCQl2YWwgPSBwa3Rbb2Zmc2V0ICsgODoob2Zmc2V0ICsgOCArICh0bHZbMF0gLSA4KSldCgkJCWlmICh0bHZbMV0gJiBUTFZfTUVUQV9UWVBFX1NUUklORykgPT0gVExWX01FVEFfVFlQRV9TVFJJTkc6CgkJCQl2YWwgPSBzdHIodmFsLnNwbGl0KE5VTExfQllURSwgMSlbMF0pCgkJCWVsaWYgKHRsdlsxXSAmIFRMVl9NRVRBX1RZUEVfVUlOVCkgPT0gVExWX01FVEFfVFlQRV9VSU5UOgoJCQkJdmFsID0gc3RydWN0LnVucGFjaygnPkknLCB2YWwpWzBdCgkJCWVsaWYgKHRsdlsxXSAmIFRMVl9NRVRBX1RZUEVfUVdPUkQpID09IFRMVl9NRVRBX1RZUEVfUVdPUkQ6CgkJCQl2YWwgPSBzdHJ1Y3QudW5wYWNrKCc+UScsIHZhbClbMF0KCQkJZWxpZiAodGx2WzFdICYgVExWX01FVEFfVFlQRV9CT09MKSA9PSBUTFZfTUVUQV9UWVBFX0JPT0w6CgkJCQl2YWwgPSBib29sKHN0cnVjdC51bnBhY2soJ2InLCB2YWwpWzBdKQoJCQllbGlmICh0bHZbMV0gJiBUTFZfTUVUQV9UWVBFX1JBVykgPT0gVExWX01FVEFfVFlQRV9SQVc6CgkJCQlwYXNzCgkJCXlpZWxkIHsndHlwZSc6IHRsdlsxXSwgJ2xlbmd0aCc6IHRsdlswXSwgJ3ZhbHVlJzogdmFsfQoJCW9mZnNldCArPSB0bHZbMF0KCXJhaXNlIFN0b3BJdGVyYXRpb24oKQoKQGV4cG9ydApkZWYgcGFja2V0X2dldF90bHYocGt0LCB0bHZfdHlwZSk6Cgl0cnk6CgkJdGx2ID0gbGlzdChwYWNrZXRfZW51bV90bHZzKHBrdCwgdGx2X3R5cGUpKVswXQoJZXhjZXB0IEluZGV4RXJyb3I6CgkJcmV0dXJuIHt9CglyZXR1cm4gdGx2CgpAZXhwb3J0CmRlZiB0bHZfcGFjaygqYXJncyk6CglpZiBsZW4oYXJncykgPT0gMjoKCQl0bHYgPSB7J3R5cGUnOmFyZ3NbMF0sICd2YWx1ZSc6YXJnc1sxXX0KCWVsc2U6CgkJdGx2ID0gYXJnc1swXQoJZGF0YSA9ICcnCgl2YWx1ZSA9IHRsdlsndmFsdWUnXQoJaWYgKHRsdlsndHlwZSddICYgVExWX01FVEFfVFlQRV9VSU5UKSA9PSBUTFZfTUVUQV9UWVBFX1VJTlQ6CgkJaWYgaXNpbnN0YW5jZSh2YWx1ZSwgZmxvYXQpOgoJCQl2YWx1ZSA9IGludChyb3VuZCh2YWx1ZSkpCgkJZGF0YSA9IHN0cnVjdC5wYWNrKCc+SUlJJywgMTIsIHRsdlsndHlwZSddLCB2YWx1ZSkKCWVsaWYgKHRsdlsndHlwZSddICYgVExWX01FVEFfVFlQRV9RV09SRCkgPT0gVExWX01FVEFfVFlQRV9RV09SRDoKCQlkYXRhID0gc3RydWN0LnBhY2soJz5JSVEnLCAxNiwgdGx2Wyd0eXBlJ10sIHZhbHVlKQoJZWxpZiAodGx2Wyd0eXBlJ10gJiBUTFZfTUVUQV9UWVBFX0JPT0wpID09IFRMVl9NRVRBX1RZUEVfQk9PTDoKCQlkYXRhID0gc3RydWN0LnBhY2soJz5JSScsIDksIHRsdlsndHlwZSddKSArIGJ5dGVzKGNocihpbnQoYm9vbCh2YWx1ZSkpKSwgJ1VURi04JykKCWVsc2U6CgkJaWYgc3lzLnZlcnNpb25faW5mb1swXSA8IDMgYW5kIHZhbHVlLl9fY2xhc3NfXy5fX25hbWVfXyA9PSAndW5pY29kZSc6CgkJCXZhbHVlID0gdmFsdWUuZW5jb2RlKCdVVEYtOCcpCgkJZWxpZiBub3QgaXNfYnl0ZXModmFsdWUpOgoJCQl2YWx1ZSA9IGJ5dGVzKHZhbHVlLCAnVVRGLTgnKQoJCWlmICh0bHZbJ3R5cGUnXSAmIFRMVl9NRVRBX1RZUEVfU1RSSU5HKSA9PSBUTFZfTUVUQV9UWVBFX1NUUklORzoKCQkJZGF0YSA9IHN0cnVjdC5wYWNrKCc+SUknLCA4ICsgbGVuKHZhbHVlKSArIDEsIHRsdlsndHlwZSddKSArIHZhbHVlICsgTlVMTF9CWVRFCgkJZWxpZiAodGx2Wyd0eXBlJ10gJiBUTFZfTUVUQV9UWVBFX1JBVykgPT0gVExWX01FVEFfVFlQRV9SQVc6CgkJCWRhdGEgPSBzdHJ1Y3QucGFjaygnPklJJywgOCArIGxlbih2YWx1ZSksIHRsdlsndHlwZSddKSArIHZhbHVlCgkJZWxpZiAodGx2Wyd0eXBlJ10gJiBUTFZfTUVUQV9UWVBFX0dST1VQKSA9PSBUTFZfTUVUQV9UWVBFX0dST1VQOgoJCQlkYXRhID0gc3RydWN0LnBhY2soJz5JSScsIDggKyBsZW4odmFsdWUpLCB0bHZbJ3R5cGUnXSkgKyB2YWx1ZQoJCWVsaWYgKHRsdlsndHlwZSddICYgVExWX01FVEFfVFlQRV9DT01QTEVYKSA9PSBUTFZfTUVUQV9UWVBFX0NPTVBMRVg6CgkJCWRhdGEgPSBzdHJ1Y3QucGFjaygnPklJJywgOCArIGxlbih2YWx1ZSksIHRsdlsndHlwZSddKSArIHZhbHVlCglyZXR1cm4gZGF0YQoKQGV4cG9ydApkZWYgdGx2X3BhY2tfcmVzcG9uc2UocmVzdWx0LCByZXNwb25zZSk6CglyZXNwb25zZSArPSB0bHZfcGFjayhUTFZfVFlQRV9SRVNVTFQsIHJlc3VsdCkKCXJlc3BvbnNlID0gc3RydWN0LnBhY2soJz5JJywgbGVuKHJlc3BvbnNlKSArIDQpICsgcmVzcG9uc2UKCXJldHVybiByZXNwb25zZQoKI0BleHBvcnQKY2xhc3MgTWV0ZXJwcmV0ZXJGaWxlKG9iamVjdCk6CglkZWYgX19pbml0X18oc2VsZiwgZmlsZV9vYmopOgoJCXNlbGYuZmlsZV9vYmogPSBmaWxlX29iagoKCWRlZiBfX2dldGF0dHJfXyhzZWxmLCBuYW1lKToKCQlyZXR1cm4gZ2V0YXR0cihzZWxmLmZpbGVfb2JqLCBuYW1lKQpleHBvcnQoTWV0ZXJwcmV0ZXJGaWxlKQoKI0BleHBvcnQKY2xhc3MgTWV0ZXJwcmV0ZXJTb2NrZXQob2JqZWN0KToKCWRlZiBfX2luaXRfXyhzZWxmLCBzb2NrKToKCQlzZWxmLnNvY2sgPSBzb2NrCgoJZGVmIF9fZ2V0YXR0cl9fKHNlbGYsIG5hbWUpOgoJCXJldHVybiBnZXRhdHRyKHNlbGYuc29jaywgbmFtZSkKZXhwb3J0KE1ldGVycHJldGVyU29ja2V0KQoKI0BleHBvcnQKY2xhc3MgTWV0ZXJwcmV0ZXJTb2NrZXRDbGllbnQoTWV0ZXJwcmV0ZXJTb2NrZXQpOgoJcGFzcwpleHBvcnQoTWV0ZXJwcmV0ZXJTb2NrZXRDbGllbnQpCgojQGV4cG9ydApjbGFzcyBNZXRlcnByZXRlclNvY2tldFNlcnZlcihNZXRlcnByZXRlclNvY2tldCk6CglwYXNzCmV4cG9ydChNZXRlcnByZXRlclNvY2tldFNlcnZlcikKCmNsYXNzIFNURFByb2Nlc3NCdWZmZXIodGhyZWFkaW5nLlRocmVhZCk6CglkZWYgX19pbml0X18oc2VsZiwgc3RkLCBpc19hbGl2ZSk6CgkJdGhyZWFkaW5nLlRocmVhZC5fX2luaXRfXyhzZWxmKQoJCXNlbGYuc3RkID0gc3RkCgkJc2VsZi5pc19hbGl2ZSA9IGlzX2FsaXZlCgkJc2VsZi5kYXRhID0gYnl0ZXMoKQoJCXNlbGYuZGF0YV9sb2NrID0gdGhyZWFkaW5nLlJMb2NrKCkKCglkZWYgcnVuKHNlbGYpOgoJCWZvciBieXRlIGluIGl0ZXIobGFtYmRhOiBzZWxmLnN0ZC5yZWFkKDEpLCBieXRlcygpKToKCQkJc2VsZi5kYXRhX2xvY2suYWNxdWlyZSgpCgkJCXNlbGYuZGF0YSArPSBieXRlCgkJCXNlbGYuZGF0YV9sb2NrLnJlbGVhc2UoKQoKCWRlZiBpc19yZWFkX3JlYWR5KHNlbGYpOgoJCXJldHVybiBsZW4oc2VsZi5kYXRhKSAhPSAwCgoJZGVmIHBlZWsoc2VsZiwgbCA9IE5vbmUpOgoJCWRhdGEgPSBieXRlcygpCgkJc2VsZi5kYXRhX2xvY2suYWNxdWlyZSgpCgkJaWYgbCA9PSBOb25lOgoJCQlkYXRhID0gc2VsZi5kYXRhCgkJZWxzZToKCQkJZGF0YSA9IHNlbGYuZGF0YVswOmxdCgkJc2VsZi5kYXRhX2xvY2sucmVsZWFzZSgpCgkJcmV0dXJuIGRhdGEKCglkZWYgcmVhZChzZWxmLCBsID0gTm9uZSk6CgkJc2VsZi5kYXRhX2xvY2suYWNxdWlyZSgpCgkJZGF0YSA9IHNlbGYucGVlayhsKQoJCXNlbGYuZGF0YSA9IHNlbGYuZGF0YVtsZW4oZGF0YSk6XQoJCXNlbGYuZGF0YV9sb2NrLnJlbGVhc2UoKQoJCXJldHVybiBkYXRhCgojQGV4cG9ydApjbGFzcyBTVERQcm9jZXNzKHN1YnByb2Nlc3MuUG9wZW4pOgoJZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CgkJZGVidWdfcHJpbnQoJ1sqXSBzdGFydGluZyBwcm9jZXNzOiAnICsgcmVwcihhcmdzWzBdKSkKCQlzdWJwcm9jZXNzLlBvcGVuLl9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncykKCQlzZWxmLmVjaG9fcHJvdGVjdGlvbiA9IEZhbHNlCgoJZGVmIHN0YXJ0KHNlbGYpOgoJCXNlbGYuc3Rkb3V0X3JlYWRlciA9IFNURFByb2Nlc3NCdWZmZXIoc2VsZi5zdGRvdXQsIGxhbWJkYTogc2VsZi5wb2xsKCkgPT0gTm9uZSkKCQlzZWxmLnN0ZG91dF9yZWFkZXIuc3RhcnQoKQoJCXNlbGYuc3RkZXJyX3JlYWRlciA9IFNURFByb2Nlc3NCdWZmZXIoc2VsZi5zdGRlcnIsIGxhbWJkYTogc2VsZi5wb2xsKCkgPT0gTm9uZSkKCQlzZWxmLnN0ZGVycl9yZWFkZXIuc3RhcnQoKQoKCWRlZiB3cml0ZShzZWxmLCBjaGFubmVsX2RhdGEpOgoJCXNlbGYuc3RkaW4ud3JpdGUoY2hhbm5lbF9kYXRhKQoJCXNlbGYuc3RkaW4uZmx1c2goKQoJCWlmIHNlbGYuZWNob19wcm90ZWN0aW9uOgoJCQllbmRfdGltZSA9IHRpbWUudGltZSgpICsgMC41CgkJCW91dF9kYXRhID0gYnl0ZXMoKQoJCQl3aGlsZSAodGltZS50aW1lKCkgPCBlbmRfdGltZSkgYW5kIChvdXRfZGF0YSAhPSBjaGFubmVsX2RhdGEpOgoJCQkJaWYgc2VsZi5zdGRvdXRfcmVhZGVyLmlzX3JlYWRfcmVhZHkoKToKCQkJCQlvdXRfZGF0YSA9IHNlbGYuc3Rkb3V0X3JlYWRlci5wZWVrKGxlbihjaGFubmVsX2RhdGEpKQoJCQlpZiBvdXRfZGF0YSA9PSBjaGFubmVsX2RhdGE6CgkJCQlzZWxmLnN0ZG91dF9yZWFkZXIucmVhZChsZW4oY2hhbm5lbF9kYXRhKSkKZXhwb3J0KFNURFByb2Nlc3MpCgpjbGFzcyBUcmFuc3BvcnQob2JqZWN0KToKCWRlZiBfX2luaXRfXyhzZWxmKToKCQlzZWxmLmNvbW11bmljYXRpb25fdGltZW91dCA9IFNFU1NJT05fQ09NTVVOSUNBVElPTl9USU1FT1VUCgkJc2VsZi5jb21tdW5pY2F0aW9uX2xhc3QgPSAwCgkJc2VsZi5yZXRyeV90b3RhbCA9IFNFU1NJT05fUkVUUllfVE9UQUwKCQlzZWxmLnJldHJ5X3dhaXQgPSBTRVNTSU9OX1JFVFJZX1dBSVQKCQlzZWxmLnJlcXVlc3RfcmV0aXJlID0gRmFsc2UKCglkZWYgX19yZXByX18oc2VsZik6CgkJcmV0dXJuICI8ezB9IHVybD0nezF9JyA+Ii5mb3JtYXQoc2VsZi5fX2NsYXNzX18uX19uYW1lX18sIHNlbGYudXJsKQoKCUBwcm9wZXJ0eQoJZGVmIGNvbW11bmljYXRpb25faGFzX2V4cGlyZWQoc2VsZik6CgkJcmV0dXJuIHNlbGYuY29tbXVuaWNhdGlvbl9sYXN0ICsgc2VsZi5jb21tdW5pY2F0aW9uX3RpbWVvdXQgPCB0aW1lLnRpbWUoKQoKCUBwcm9wZXJ0eQoJZGVmIHNob3VsZF9yZXRpcmUoc2VsZik6CgkJcmV0dXJuIHNlbGYuY29tbXVuaWNhdGlvbl9oYXNfZXhwaXJlZCBvciBzZWxmLnJlcXVlc3RfcmV0aXJlCgoJQHN0YXRpY21ldGhvZAoJZGVmIGZyb21fcmVxdWVzdChyZXF1ZXN0KToKCQl1cmwgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9UUkFOU19VUkwpWyd2YWx1ZSddCgkJaWYgdXJsLnN0YXJ0c3dpdGgoJ3RjcCcpOgoJCQl0cmFuc3BvcnQgPSBUY3BUcmFuc3BvcnQodXJsKQoJCWVsaWYgdXJsLnN0YXJ0c3dpdGgoJ2h0dHAnKToKCQkJcHJveHkgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9UUkFOU19QUk9YWV9IT1NUKS5nZXQoJ3ZhbHVlJykKCQkJdXNlcl9hZ2VudCA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX1RSQU5TX1VBKS5nZXQoJ3ZhbHVlJywgSFRUUF9VU0VSX0FHRU5UKQoJCQl0cmFuc3BvcnQgPSBIdHRwVHJhbnNwb3J0KHVybCwgcHJveHk9cHJveHksIHVzZXJfYWdlbnQ9dXNlcl9hZ2VudCkKCQl0cmFuc3BvcnQuY29tbXVuaWNhdGlvbl90aW1lb3V0ID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfVFJBTlNfQ09NTV9USU1FT1VUKS5nZXQoJ3ZhbHVlJywgU0VTU0lPTl9DT01NVU5JQ0FUSU9OX1RJTUVPVVQpCgkJdHJhbnNwb3J0LnJldHJ5X3RvdGFsID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfVFJBTlNfUkVUUllfVE9UQUwpLmdldCgndmFsdWUnLCBTRVNTSU9OX1JFVFJZX1RPVEFMKQoJCXRyYW5zcG9ydC5yZXRyeV93YWl0ID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfVFJBTlNfUkVUUllfV0FJVCkuZ2V0KCd2YWx1ZScsIFNFU1NJT05fUkVUUllfV0FJVCkKCQlyZXR1cm4gdHJhbnNwb3J0CgoJZGVmIF9hY3RpdmF0ZShzZWxmKToKCQlyZXR1cm4gVHJ1ZQoKCWRlZiBhY3RpdmF0ZShzZWxmKToKCQllbmRfdGltZSA9IHRpbWUudGltZSgpICsgc2VsZi5yZXRyeV90b3RhbAoJCXdoaWxlIHRpbWUudGltZSgpIDwgZW5kX3RpbWU6CgkJCXRyeToKCQkJCWFjdGl2YXRlX3N1Y2NlZWRlZCA9IHNlbGYuX2FjdGl2YXRlKCkKCQkJZXhjZXB0OgoJCQkJYWN0aXZhdGVfc3VjY2VlZGVkID0gRmFsc2UKCQkJaWYgYWN0aXZhdGVfc3VjY2VlZGVkOgoJCQkJc2VsZi5jb21tdW5pY2F0aW9uX2xhc3QgPSB0aW1lLnRpbWUoKQoJCQkJcmV0dXJuIFRydWUKCQkJdGltZS5zbGVlcChzZWxmLnJldHJ5X3dhaXQpCgkJcmV0dXJuIEZhbHNlCgoJZGVmIF9kZWFjdGl2YXRlKHNlbGYpOgoJCXJldHVybgoKCWRlZiBkZWFjdGl2YXRlKHNlbGYpOgoJCXRyeToKCQkJc2VsZi5fZGVhY3RpdmF0ZSgpCgkJZXhjZXB0OgoJCQlwYXNzCgkJc2VsZi5jb21tdW5pY2F0aW9uX2xhc3QgPSAwCgkJcmV0dXJuIFRydWUKCglkZWYgZ2V0X3BhY2tldChzZWxmKToKCQlzZWxmLnJlcXVlc3RfcmV0aXJlID0gRmFsc2UKCQl0cnk6CgkJCXBrdCA9IHNlbGYuX2dldF9wYWNrZXQoKQoJCWV4Y2VwdDoKCQkJcmV0dXJuIE5vbmUKCQlpZiBwa3QgaXMgTm9uZToKCQkJcmV0dXJuIE5vbmUKCQlzZWxmLmNvbW11bmljYXRpb25fbGFzdCA9IHRpbWUudGltZSgpCgkJcmV0dXJuIHBrdAoKCWRlZiBzZW5kX3BhY2tldChzZWxmLCBwa3QpOgoJCXNlbGYucmVxdWVzdF9yZXRpcmUgPSBGYWxzZQoJCXRyeToKCQkJeG9yX2tleSA9IHJhbmRfeG9yX2tleSgpCgkJCXJhdyA9IHN0cnVjdC5wYWNrKCdCQkJCJywgKnhvcl9rZXlbOjotMV0pICsgeG9yX2J5dGVzKHhvcl9rZXksIHBrdCkKCQkJc2VsZi5fc2VuZF9wYWNrZXQocmF3KQoJCWV4Y2VwdDoKCQkJcmV0dXJuIEZhbHNlCgkJc2VsZi5jb21tdW5pY2F0aW9uX2xhc3QgPSB0aW1lLnRpbWUoKQoJCXJldHVybiBUcnVlCgoJZGVmIHRsdl9wYWNrX3RpbWVvdXRzKHNlbGYpOgoJCXJlc3BvbnNlICA9IHRsdl9wYWNrKFRMVl9UWVBFX1RSQU5TX0NPTU1fVElNRU9VVCwgc2VsZi5jb21tdW5pY2F0aW9uX3RpbWVvdXQpCgkJcmVzcG9uc2UgKz0gdGx2X3BhY2soVExWX1RZUEVfVFJBTlNfUkVUUllfVE9UQUwsIHNlbGYucmV0cnlfdG90YWwpCgkJcmVzcG9uc2UgKz0gdGx2X3BhY2soVExWX1RZUEVfVFJBTlNfUkVUUllfV0FJVCwgc2VsZi5yZXRyeV93YWl0KQoJCXJldHVybiByZXNwb25zZQoKCWRlZiB0bHZfcGFja190cmFuc3BvcnRfZ3JvdXAoc2VsZik6CgkJdHJhbnNfZ3JvdXAgID0gdGx2X3BhY2soVExWX1RZUEVfVFJBTlNfVVJMLCBzZWxmLnVybCkKCQl0cmFuc19ncm91cCArPSBzZWxmLnRsdl9wYWNrX3RpbWVvdXRzKCkKCQlyZXR1cm4gdHJhbnNfZ3JvdXAKCmNsYXNzIEh0dHBUcmFuc3BvcnQoVHJhbnNwb3J0KToKCWRlZiBfX2luaXRfXyhzZWxmLCB1cmwsIHByb3h5PU5vbmUsIHVzZXJfYWdlbnQ9Tm9uZSk6CgkJc3VwZXIoSHR0cFRyYW5zcG9ydCwgc2VsZikuX19pbml0X18oKQoJCW9wZW5lcl9hcmdzID0gW10KCQlzY2hlbWUgPSB1cmwuc3BsaXQoJzonLCAxKVswXQoJCWlmIHNjaGVtZSA9PSAnaHR0cHMnIGFuZCAoKHN5cy52ZXJzaW9uX2luZm9bMF0gPT0gMiBhbmQgc3lzLnZlcnNpb25faW5mbyA+PSAoMiwgNywgOSkpIG9yIHN5cy52ZXJzaW9uX2luZm8gPj0gKDMsIDQsIDMpKToKCQkJaW1wb3J0IHNzbAoJCQlzc2xfY3R4ID0gc3NsLlNTTENvbnRleHQoc3NsLlBST1RPQ09MX1NTTHYyMykKCQkJc3NsX2N0eC5jaGVja19ob3N0bmFtZSA9IEZhbHNlCgkJCXNzbF9jdHgudmVyaWZ5X21vZGUgPSBzc2wuQ0VSVF9OT05FCgkJCW9wZW5lcl9hcmdzLmFwcGVuZCh1cmxsaWIuSFRUUFNIYW5kbGVyKDAsIHNzbF9jdHgpKQoJCWlmIHByb3h5OgoJCQlvcGVuZXJfYXJncy5hcHBlbmQodXJsbGliLlByb3h5SGFuZGxlcih7c2NoZW1lOiBwcm94eX0pKQoJCXNlbGYucHJveHkgPSBwcm94eQoJCW9wZW5lciA9IHVybGxpYi5idWlsZF9vcGVuZXIoKm9wZW5lcl9hcmdzKQoJCWlmIHVzZXJfYWdlbnQ6CgkJCW9wZW5lci5hZGRoZWFkZXJzID0gWygnVXNlci1BZ2VudCcsIHVzZXJfYWdlbnQpXQoJCXNlbGYudXNlcl9hZ2VudCA9IHVzZXJfYWdlbnQKCQl1cmxsaWIuaW5zdGFsbF9vcGVuZXIob3BlbmVyKQoJCXNlbGYudXJsID0gdXJsCgkJc2VsZi5faHR0cF9yZXF1ZXN0X2hlYWRlcnMgPSB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nfQoJCXNlbGYuX2ZpcnN0X3BhY2tldCA9IE5vbmUKCQlzZWxmLl9lbXB0eV9jbnQgPSAwCgoJZGVmIF9hY3RpdmF0ZShzZWxmKToKCQlyZXR1cm4gVHJ1ZQoJCXNlbGYuX2ZpcnN0X3BhY2tldCA9IE5vbmUKCQlwYWNrZXQgPSBzZWxmLl9nZXRfcGFja2V0KCkKCQlpZiBwYWNrZXQgaXMgTm9uZToKCQkJcmV0dXJuIEZhbHNlCgkJc2VsZi5fZmlyc3RfcGFja2V0ID0gcGFja2V0CgkJcmV0dXJuIFRydWUKCglkZWYgX2dldF9wYWNrZXQoc2VsZik6CgkJaWYgc2VsZi5fZmlyc3RfcGFja2V0OgoJCQlwYWNrZXQgPSBzZWxmLl9maXJzdF9wYWNrZXQKCQkJc2VsZi5fZmlyc3RfcGFja2V0ID0gTm9uZQoJCQlyZXR1cm4gcGFja2V0CgkJcGFja2V0ID0gTm9uZQoJCXhvcl9rZXkgPSBOb25lCgkJcmVxdWVzdCA9IHVybGxpYi5SZXF1ZXN0KHNlbGYudXJsLCBOb25lLCBzZWxmLl9odHRwX3JlcXVlc3RfaGVhZGVycykKCQl1cmxfaCA9IHVybGxpYi51cmxvcGVuKHJlcXVlc3QsIHRpbWVvdXQ9c2VsZi5jb21tdW5pY2F0aW9uX3RpbWVvdXQpCgkJcGFja2V0ID0gdXJsX2gucmVhZCgpCgkJZm9yIF8gaW4gcmFuZ2UoMSk6CgkJCWlmIHBhY2tldCA9PSAnJzoKCQkJCWJyZWFrCgkJCWlmIGxlbihwYWNrZXQpIDwgMTI6CgkJCQlwYWNrZXQgPSBOb25lICAjIGxvb2tzIGNvcnJ1cHQKCQkJCWJyZWFrCgkJCXhvcl9rZXkgPSBzdHJ1Y3QudW5wYWNrKCdCQkJCJywgcGFja2V0Wzo0XVs6Oi0xXSkKCQkJaGVhZGVyID0geG9yX2J5dGVzKHhvcl9rZXksIHBhY2tldFs0OjEyXSkKCQkJcGt0X2xlbmd0aCwgXyA9IHN0cnVjdC51bnBhY2soJz5JSScsIGhlYWRlcikKCQkJaWYgbGVuKHBhY2tldCkgLSA0ICE9IHBrdF9sZW5ndGg6CgkJCQlwYWNrZXQgPSBOb25lICAjIGxvb2tzIGNvcnJ1cHQKCQlpZiBub3QgcGFja2V0OgoJCQlkZWxheSA9IDEwICogc2VsZi5fZW1wdHlfY250CgkJCWlmIHNlbGYuX2VtcHR5X2NudCA+PSAwOgoJCQkJZGVsYXkgKj0gMTAKCQkJc2VsZi5fZW1wdHlfY250ICs9IDEKCQkJdGltZS5zbGVlcChmbG9hdChtaW4oMTAwMDAsIGRlbGF5KSkgLyAxMDAwKQoJCQlyZXR1cm4gcGFja2V0CgkJc2VsZi5fZW1wdHlfY250ID0gMAoJCXJldHVybiB4b3JfYnl0ZXMoeG9yX2tleSwgcGFja2V0WzEyOl0pCgoJZGVmIF9zZW5kX3BhY2tldChzZWxmLCBwYWNrZXQpOgoJCXJlcXVlc3QgPSB1cmxsaWIuUmVxdWVzdChzZWxmLnVybCwgcGFja2V0LCBzZWxmLl9odHRwX3JlcXVlc3RfaGVhZGVycykKCQl1cmxfaCA9IHVybGxpYi51cmxvcGVuKHJlcXVlc3QsIHRpbWVvdXQ9c2VsZi5jb21tdW5pY2F0aW9uX3RpbWVvdXQpCgkJcmVzcG9uc2UgPSB1cmxfaC5yZWFkKCkKCglkZWYgcGF0Y2hfdXJpX3BhdGgoc2VsZiwgbmV3X3BhdGgpOgoJCW1hdGNoID0gcmUubWF0Y2gocidodHRwcz86Ly9bXi9dKygvLiokKScsIHNlbGYudXJsKQoJCWlmIG1hdGNoIGlzIE5vbmU6CgkJCXJldHVybiBGYWxzZQoJCXNlbGYudXJsID0gc2VsZi51cmxbOm1hdGNoLnNwYW4oMSlbMF1dICsgbmV3X3BhdGgKCQlyZXR1cm4gVHJ1ZQoKCWRlZiB0bHZfcGFja190cmFuc3BvcnRfZ3JvdXAoc2VsZik6CgkJdHJhbnNfZ3JvdXAgID0gc3VwZXIoSHR0cFRyYW5zcG9ydCwgc2VsZikudGx2X3BhY2tfdHJhbnNwb3J0X2dyb3VwKCkKCQlpZiBzZWxmLnVzZXJfYWdlbnQ6CgkJCXRyYW5zX2dyb3VwICs9IHRsdl9wYWNrKFRMVl9UWVBFX1RSQU5TX1VBLCBzZWxmLnVzZXJfYWdlbnQpCgkJaWYgc2VsZi5wcm94eToKCQkJdHJhbnNfZ3JvdXAgKz0gdGx2X3BhY2soVExWX1RZUEVfVFJBTlNfUFJPWFlfSE9TVCwgc2VsZi5wcm94eSkKCQlyZXR1cm4gdHJhbnNfZ3JvdXAKCmNsYXNzIFRjcFRyYW5zcG9ydChUcmFuc3BvcnQpOgoJZGVmIF9faW5pdF9fKHNlbGYsIHVybCwgc29ja2V0PU5vbmUpOgoJCXN1cGVyKFRjcFRyYW5zcG9ydCwgc2VsZikuX19pbml0X18oKQoJCXNlbGYudXJsID0gdXJsCgkJc2VsZi5zb2NrZXQgPSBzb2NrZXQKCQlzZWxmLl9jbGVhbnVwX3RocmVhZCA9IE5vbmUKCQlzZWxmLl9maXJzdF9wYWNrZXQgPSBUcnVlCgoJZGVmIF9zb2NrX2NsZWFudXAoc2VsZiwgc29jayk6CgkJcmVtYWluaW5nX3RpbWUgPSBzZWxmLmNvbW11bmljYXRpb25fdGltZW91dAoJCXdoaWxlIHJlbWFpbmluZ190aW1lID4gMDoKCQkJaXRlcl9zdGFydF90aW1lID0gdGltZS50aW1lKCkKCQkJaWYgc2VsZWN0LnNlbGVjdChbc29ja10sIFtdLCBbXSwgcmVtYWluaW5nX3RpbWUpWzBdOgoJCQkJaWYgbGVuKHNvY2sucmVjdig0MDk2KSkgPT0gMDoKCQkJCQlicmVhawoJCQlyZW1haW5pbmdfdGltZSAtPSB0aW1lLnRpbWUoKSAtIGl0ZXJfc3RhcnRfdGltZQoJCXNvY2suY2xvc2UoKQoKCWRlZiBfYWN0aXZhdGUoc2VsZik6CgkJYWRkcmVzcywgcG9ydCA9IHNlbGYudXJsWzY6XS5yc3BsaXQoJzonLCAxKQoJCXBvcnQgPSBpbnQocG9ydC5yc3RyaXAoJy8nKSkKCQl0aW1lb3V0ID0gbWF4KHNlbGYuY29tbXVuaWNhdGlvbl90aW1lb3V0LCAzMCkKCQlpZiBhZGRyZXNzIGluICgnJywgJzAuMC4wLjAnLCAnOjonKToKCQkJdHJ5OgoJCQkJc2VydmVyX3NvY2sgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVUNiwgc29ja2V0LlNPQ0tfU1RSRUFNKQoJCQkJc2VydmVyX3NvY2suc2V0c29ja29wdChzb2NrZXQuSVBQUk9UT19JUFY2LCBzb2NrZXQuSVBWNl9WNk9OTFksIDApCgkJCWV4Y2VwdCAoQXR0cmlidXRlRXJyb3IsIHNvY2tldC5lcnJvcik6CgkJCQlzZXJ2ZXJfc29jayA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSkKCQkJc2VydmVyX3NvY2suYmluZCgoJycsIHBvcnQpKQoJCQlzZXJ2ZXJfc29jay5saXN0ZW4oMSkKCQkJaWYgbm90IHNlbGVjdC5zZWxlY3QoW3NlcnZlcl9zb2NrXSwgW10sIFtdLCB0aW1lb3V0KVswXToKCQkJCXNlcnZlcl9zb2NrLmNsb3NlKCkKCQkJCXJldHVybiBGYWxzZQoJCQlzb2NrLCBfID0gc2VydmVyX3NvY2suYWNjZXB0KCkKCQkJc2VydmVyX3NvY2suY2xvc2UoKQoJCWVsc2U6CgkJCWlmICc6JyBpbiBhZGRyZXNzOgoJCQkJc29jayA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQ2LCBzb2NrZXQuU09DS19TVFJFQU0pCgkJCWVsc2U6CgkJCQlzb2NrID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQoJCQlzb2NrLnNldHRpbWVvdXQodGltZW91dCkKCQkJc29jay5jb25uZWN0KChhZGRyZXNzLCBwb3J0KSkKCQkJc29jay5zZXR0aW1lb3V0KE5vbmUpCgkJc2VsZi5zb2NrZXQgPSBzb2NrCgkJc2VsZi5fZmlyc3RfcGFja2V0ID0gVHJ1ZQoJCXJldHVybiBUcnVlCgoJZGVmIF9kZWFjdGl2YXRlKHNlbGYpOgoJCWNsZWFudXAgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1zZWxmLl9zb2NrX2NsZWFudXAsIGFyZ3M9KHNlbGYuc29ja2V0LCkpCgkJY2xlYW51cC5ydW4oKQoJCXNlbGYuc29ja2V0ID0gTm9uZQoKCWRlZiBfZ2V0X3BhY2tldChzZWxmKToKCQlmaXJzdCA9IHNlbGYuX2ZpcnN0X3BhY2tldAoJCXNlbGYuX2ZpcnN0X3BhY2tldCA9IEZhbHNlCgkJaWYgbm90IHNlbGVjdC5zZWxlY3QoW3NlbGYuc29ja2V0XSwgW10sIFtdLCAwLjUpWzBdOgoJCQlyZXR1cm4gJycKCQlwYWNrZXQgPSBzZWxmLnNvY2tldC5yZWN2KDEyKQoJCWlmIHBhY2tldCA9PSAnJzogICMgcmVtb3RlIGlzIGNsb3NlZAoJCQlzZWxmLnJlcXVlc3RfcmV0aXJlID0gVHJ1ZQoJCQlyZXR1cm4gTm9uZQoJCWlmIGxlbihwYWNrZXQpICE9IDEyOgoJCQlpZiBmaXJzdCBhbmQgbGVuKHBhY2tldCkgPT0gNDoKCQkJCXJlY2VpdmVkID0gMAoJCQkJaGVhZGVyID0gcGFja2V0Wzo0XQoJCQkJcGt0X2xlbmd0aCA9IHN0cnVjdC51bnBhY2soJz5JJywgaGVhZGVyKVswXQoJCQkJc2VsZi5zb2NrZXQuc2V0dGltZW91dChtYXgoc2VsZi5jb21tdW5pY2F0aW9uX3RpbWVvdXQsIDMwKSkKCQkJCXdoaWxlIHJlY2VpdmVkIDwgcGt0X2xlbmd0aDoKCQkJCQlyZWNlaXZlZCArPSBsZW4oc2VsZi5zb2NrZXQucmVjdihwa3RfbGVuZ3RoIC0gcmVjZWl2ZWQpKQoJCQkJc2VsZi5zb2NrZXQuc2V0dGltZW91dChOb25lKQoJCQkJcmV0dXJuIHNlbGYuX2dldF9wYWNrZXQoKQoJCQlyZXR1cm4gTm9uZQoKCQl4b3Jfa2V5ID0gc3RydWN0LnVucGFjaygnQkJCQicsIHBhY2tldFs6NF1bOjotMV0pCgkJaGVhZGVyID0geG9yX2J5dGVzKHhvcl9rZXksIHBhY2tldFs0OjEyXSkKCQlwa3RfbGVuZ3RoLCBwa3RfdHlwZSA9IHN0cnVjdC51bnBhY2soJz5JSScsIGhlYWRlcikKCQlwa3RfbGVuZ3RoIC09IDgKCQlwYWNrZXQgPSBieXRlcygpCgkJd2hpbGUgbGVuKHBhY2tldCkgPCBwa3RfbGVuZ3RoOgoJCQlwYWNrZXQgKz0gc2VsZi5zb2NrZXQucmVjdihwa3RfbGVuZ3RoIC0gbGVuKHBhY2tldCkpCgkJcmV0dXJuIHhvcl9ieXRlcyh4b3Jfa2V5LCBwYWNrZXQpCgoJZGVmIF9zZW5kX3BhY2tldChzZWxmLCBwYWNrZXQpOgoJCXNlbGYuc29ja2V0LnNlbmQocGFja2V0KQoKCUBjbGFzc21ldGhvZAoJZGVmIGZyb21fc29ja2V0KGNscywgc29jayk6CgkJdXJsID0gJ3RjcDovLycKCQlhZGRyZXNzLCBwb3J0ID0gc29jay5nZXRzb2NrbmFtZSgpWzoyXQoJCSMgdGhpcyB3aWxsIG5lZWQgdG8gYmUgY2hhbmdlZCBpZiB0aGUgYmluZCBzdGFnZXIgZXZlciBzdXBwb3J0cyBiaW5kaW5nIHRvIGEgc3BlY2lmaWMgYWRkcmVzcwoJCWlmIG5vdCBhZGRyZXNzIGluICgnJywgJzAuMC4wLjAnLCAnOjonKToKCQkJYWRkcmVzcywgcG9ydCA9IHNvY2suZ2V0cGVlcm5hbWUoKVs6Ml0KCQl1cmwgKz0gYWRkcmVzcyArICc6JyArIHN0cihwb3J0KQoJCXJldHVybiBjbHModXJsLCBzb2NrKQoKY2xhc3MgUHl0aG9uTWV0ZXJwcmV0ZXIob2JqZWN0KToKCWRlZiBfX2luaXRfXyhzZWxmLCB0cmFuc3BvcnQpOgoJCXNlbGYudHJhbnNwb3J0ID0gdHJhbnNwb3J0CgkJc2VsZi5ydW5uaW5nID0gRmFsc2UKCQlzZWxmLmxhc3RfcmVnaXN0ZXJlZF9leHRlbnNpb24gPSBOb25lCgkJc2VsZi5leHRlbnNpb25fZnVuY3Rpb25zID0ge30KCQlzZWxmLmNoYW5uZWxzID0ge30KCQlzZWxmLm5leHRfY2hhbm5lbF9pZCA9IDEKCQlzZWxmLmludGVyYWN0X2NoYW5uZWxzID0gW10KCQlzZWxmLnByb2Nlc3NlcyA9IHt9CgkJc2VsZi5uZXh0X3Byb2Nlc3NfaWQgPSAxCgkJc2VsZi50cmFuc3BvcnRzID0gW3NlbGYudHJhbnNwb3J0XQoJCXNlbGYuc2Vzc2lvbl9leHBpcnlfdGltZSA9IFNFU1NJT05fRVhQSVJBVElPTl9USU1FT1VUCgkJc2VsZi5zZXNzaW9uX2V4cGlyeV9lbmQgPSB0aW1lLnRpbWUoKSArIHNlbGYuc2Vzc2lvbl9leHBpcnlfdGltZQoJCWZvciBmdW5jIGluIGxpc3QoZmlsdGVyKGxhbWJkYSB4OiB4LnN0YXJ0c3dpdGgoJ19jb3JlJyksIGRpcihzZWxmKSkpOgoJCQlzZWxmLmV4dGVuc2lvbl9mdW5jdGlvbnNbZnVuY1sxOl1dID0gZ2V0YXR0cihzZWxmLCBmdW5jKQoJCXNlbGYucnVubmluZyA9IFRydWUKCglkZWYgcmVnaXN0ZXJfZXh0ZW5zaW9uKHNlbGYsIGV4dGVuc2lvbl9uYW1lKToKCQlzZWxmLmxhc3RfcmVnaXN0ZXJlZF9leHRlbnNpb24gPSBleHRlbnNpb25fbmFtZQoJCXJldHVybiBzZWxmLmxhc3RfcmVnaXN0ZXJlZF9leHRlbnNpb24KCglkZWYgcmVnaXN0ZXJfZnVuY3Rpb24oc2VsZiwgZnVuYyk6CgkJc2VsZi5leHRlbnNpb25fZnVuY3Rpb25zW2Z1bmMuX19uYW1lX19dID0gZnVuYwoJCXJldHVybiBmdW5jCgoJZGVmIHJlZ2lzdGVyX2Z1bmN0aW9uX3dpbmRsbChzZWxmLCBmdW5jKToKCQlpZiBoYXNfd2luZGxsOgoJCQlzZWxmLnJlZ2lzdGVyX2Z1bmN0aW9uKGZ1bmMpCgkJcmV0dXJuIGZ1bmMKCglkZWYgYWRkX2NoYW5uZWwoc2VsZiwgY2hhbm5lbCk6CgkJYXNzZXJ0KGlzaW5zdGFuY2UoY2hhbm5lbCwgKHN1YnByb2Nlc3MuUG9wZW4sIE1ldGVycHJldGVyRmlsZSwgTWV0ZXJwcmV0ZXJTb2NrZXQpKSkKCQlpZHggPSBzZWxmLm5leHRfY2hhbm5lbF9pZAoJCXNlbGYuY2hhbm5lbHNbaWR4XSA9IGNoYW5uZWwKCQlkZWJ1Z19wcmludCgnWypdIGFkZGVkIGNoYW5uZWwgaWQ6ICcgKyBzdHIoaWR4KSArICcgdHlwZTogJyArIGNoYW5uZWwuX19jbGFzc19fLl9fbmFtZV9fKQoJCXNlbGYubmV4dF9jaGFubmVsX2lkICs9IDEKCQlyZXR1cm4gaWR4CgoJZGVmIGFkZF9wcm9jZXNzKHNlbGYsIHByb2Nlc3MpOgoJCWlkeCA9IHNlbGYubmV4dF9wcm9jZXNzX2lkCgkJc2VsZi5wcm9jZXNzZXNbaWR4XSA9IHByb2Nlc3MKCQlkZWJ1Z19wcmludCgnWypdIGFkZGVkIHByb2Nlc3MgaWQ6ICcgKyBzdHIoaWR4KSkKCQlzZWxmLm5leHRfcHJvY2Vzc19pZCArPSAxCgkJcmV0dXJuIGlkeAoKCWRlZiBnZXRfcGFja2V0KHNlbGYpOgoJCXBrdCA9IHNlbGYudHJhbnNwb3J0LmdldF9wYWNrZXQoKQoJCWlmIHBrdCBpcyBOb25lIGFuZCBzZWxmLnRyYW5zcG9ydC5zaG91bGRfcmV0aXJlOgoJCQlzZWxmLnRyYW5zcG9ydF9jaGFuZ2UoKQoJCXJldHVybiBwa3QKCglkZWYgc2VuZF9wYWNrZXQoc2VsZiwgcGFja2V0KToKCQlzZW5kX3N1Y2NlZWRlZCA9IHNlbGYudHJhbnNwb3J0LnNlbmRfcGFja2V0KHBhY2tldCkKCQlpZiBub3Qgc2VuZF9zdWNjZWVkZWQgYW5kIHNlbGYudHJhbnNwb3J0LnNob3VsZF9yZXRpcmU6CgkJCXNlbGYudHJhbnNwb3J0X2NoYW5nZSgpCgkJcmV0dXJuIHNlbmRfc3VjY2VlZGVkCgoJQHByb3BlcnR5CglkZWYgc2Vzc2lvbl9oYXNfZXhwaXJlZChzZWxmKToKCQlpZiBzZWxmLnNlc3Npb25fZXhwaXJ5X3RpbWUgPT0gMDoKCQkJcmV0dXJuIEZhbHNlCgkJcmV0dXJuIHRpbWUudGltZSgpID4gc2VsZi5zZXNzaW9uX2V4cGlyeV9lbmQKCglkZWYgdHJhbnNwb3J0X2FkZChzZWxmLCBuZXdfdHJhbnNwb3J0KToKCQluZXdfcG9zaXRpb24gPSBzZWxmLnRyYW5zcG9ydHMuaW5kZXgoc2VsZi50cmFuc3BvcnQpCgkJc2VsZi50cmFuc3BvcnRzLmluc2VydChuZXdfcG9zaXRpb24sIG5ld190cmFuc3BvcnQpCgoJZGVmIHRyYW5zcG9ydF9jaGFuZ2Uoc2VsZiwgbmV3X3RyYW5zcG9ydD1Ob25lKToKCQlpZiBuZXdfdHJhbnNwb3J0IGlzIE5vbmU6CgkJCW5ld190cmFuc3BvcnQgPSBzZWxmLnRyYW5zcG9ydF9uZXh0KCkKCQlzZWxmLnRyYW5zcG9ydC5kZWFjdGl2YXRlKCkKCQlkZWJ1Z19wcmludCgnWypdIGNoYW5naW5nIHRyYW5zcG9ydCB0bzogJyArIG5ld190cmFuc3BvcnQudXJsKQoJCXdoaWxlIG5vdCBuZXdfdHJhbnNwb3J0LmFjdGl2YXRlKCk6CgkJCW5ld190cmFuc3BvcnQgPSBzZWxmLnRyYW5zcG9ydF9uZXh0KG5ld190cmFuc3BvcnQpCgkJCWRlYnVnX3ByaW50KCdbKl0gY2hhbmdpbmcgdHJhbnNwb3J0IHRvOiAnICsgbmV3X3RyYW5zcG9ydC51cmwpCgkJc2VsZi50cmFuc3BvcnQgPSBuZXdfdHJhbnNwb3J0CgoJZGVmIHRyYW5zcG9ydF9uZXh0KHNlbGYsIGN1cnJlbnRfdHJhbnNwb3J0PU5vbmUpOgoJCWlmIGN1cnJlbnRfdHJhbnNwb3J0IGlzIE5vbmU6CgkJCWN1cnJlbnRfdHJhbnNwb3J0ID0gc2VsZi50cmFuc3BvcnQKCQluZXdfaWR4ID0gc2VsZi50cmFuc3BvcnRzLmluZGV4KGN1cnJlbnRfdHJhbnNwb3J0KSArIDEKCQlpZiBuZXdfaWR4ID09IGxlbihzZWxmLnRyYW5zcG9ydHMpOgoJCQluZXdfaWR4ID0gMAoJCXJldHVybiBzZWxmLnRyYW5zcG9ydHNbbmV3X2lkeF0KCglkZWYgdHJhbnNwb3J0X3ByZXYoc2VsZiwgY3VycmVudF90cmFuc3BvcnQ9Tm9uZSk6CgkJaWYgY3VycmVudF90cmFuc3BvcnQgaXMgTm9uZToKCQkJY3VycmVudF90cmFuc3BvcnQgPSBzZWxmLnRyYW5zcG9ydAoJCW5ld19pZHggPSBzZWxmLnRyYW5zcG9ydHMuaW5kZXgoY3VycmVudF90cmFuc3BvcnQpIC0gMQoJCWlmIG5ld19pZHggPT0gLTE6CgkJCW5ld19pZHggPSBsZW4oc2VsZi50cmFuc3BvcnRzKSAtIDEKCQlyZXR1cm4gc2VsZi50cmFuc3BvcnRzW25ld19pZHhdCgoJZGVmIHJ1bihzZWxmKToKCQl3aGlsZSBzZWxmLnJ1bm5pbmcgYW5kIG5vdCBzZWxmLnNlc3Npb25faGFzX2V4cGlyZWQ6CgkJCXJlcXVlc3QgPSBzZWxmLmdldF9wYWNrZXQoKQoJCQlpZiByZXF1ZXN0OgoJCQkJcmVzcG9uc2UgPSBzZWxmLmNyZWF0ZV9yZXNwb25zZShyZXF1ZXN0KQoJCQkJaWYgcmVzcG9uc2U6CgkJCQkJc2VsZi5zZW5kX3BhY2tldChyZXNwb25zZSkKCQkJCWNvbnRpbnVlCgkJCSMgaXRlcmF0ZSBvdmVyIHRoZSBrZXlzIGJlY2F1c2Ugc2VsZi5jaGFubmVscyBjb3VsZCBiZSBtb2RpZmllZCBpZiBvbmUgaXMgY2xvc2VkCgkJCWNoYW5uZWxfaWRzID0gbGlzdChzZWxmLmNoYW5uZWxzLmtleXMoKSkKCQkJZm9yIGNoYW5uZWxfaWQgaW4gY2hhbm5lbF9pZHM6CgkJCQljaGFubmVsID0gc2VsZi5jaGFubmVsc1tjaGFubmVsX2lkXQoJCQkJZGF0YSA9IGJ5dGVzKCkKCQkJCWlmIGlzaW5zdGFuY2UoY2hhbm5lbCwgU1REUHJvY2Vzcyk6CgkJCQkJaWYgbm90IGNoYW5uZWxfaWQgaW4gc2VsZi5pbnRlcmFjdF9jaGFubmVsczoKCQkJCQkJY29udGludWUKCQkJCQlpZiBjaGFubmVsLnN0ZGVycl9yZWFkZXIuaXNfcmVhZF9yZWFkeSgpOgoJCQkJCQlkYXRhID0gY2hhbm5lbC5zdGRlcnJfcmVhZGVyLnJlYWQoKQoJCQkJCWVsaWYgY2hhbm5lbC5zdGRvdXRfcmVhZGVyLmlzX3JlYWRfcmVhZHkoKToKCQkJCQkJZGF0YSA9IGNoYW5uZWwuc3Rkb3V0X3JlYWRlci5yZWFkKCkKCQkJCQllbGlmIGNoYW5uZWwucG9sbCgpICE9IE5vbmU6CgkJCQkJCXNlbGYuaGFuZGxlX2RlYWRfcmVzb3VyY2VfY2hhbm5lbChjaGFubmVsX2lkKQoJCQkJZWxpZiBpc2luc3RhbmNlKGNoYW5uZWwsIE1ldGVycHJldGVyU29ja2V0Q2xpZW50KToKCQkJCQl3aGlsZSBzZWxlY3Quc2VsZWN0KFtjaGFubmVsLmZpbGVubygpXSwgW10sIFtdLCAwKVswXToKCQkJCQkJdHJ5OgoJCQkJCQkJZCA9IGNoYW5uZWwucmVjdigxKQoJCQkJCQlleGNlcHQgc29ja2V0LmVycm9yOgoJCQkJCQkJZCA9IGJ5dGVzKCkKCQkJCQkJaWYgbGVuKGQpID09IDA6CgkJCQkJCQlzZWxmLmhhbmRsZV9kZWFkX3Jlc291cmNlX2NoYW5uZWwoY2hhbm5lbF9pZCkKCQkJCQkJCWJyZWFrCgkJCQkJCWRhdGEgKz0gZAoJCQkJZWxpZiBpc2luc3RhbmNlKGNoYW5uZWwsIE1ldGVycHJldGVyU29ja2V0U2VydmVyKToKCQkJCQlpZiBzZWxlY3Quc2VsZWN0KFtjaGFubmVsLmZpbGVubygpXSwgW10sIFtdLCAwKVswXToKCQkJCQkJKGNsaWVudF9zb2NrLCBjbGllbnRfYWRkcikgPSBjaGFubmVsLmFjY2VwdCgpCgkJCQkJCXNlcnZlcl9hZGRyID0gY2hhbm5lbC5nZXRzb2NrbmFtZSgpCgkJCQkJCWNsaWVudF9jaGFubmVsX2lkID0gc2VsZi5hZGRfY2hhbm5lbChNZXRlcnByZXRlclNvY2tldENsaWVudChjbGllbnRfc29jaykpCgkJCQkJCXBrdCAgPSBzdHJ1Y3QucGFjaygnPkknLCBQQUNLRVRfVFlQRV9SRVFVRVNUKQoJCQkJCQlwa3QgKz0gdGx2X3BhY2soVExWX1RZUEVfTUVUSE9ELCAndGNwX2NoYW5uZWxfb3BlbicpCgkJCQkJCXBrdCArPSB0bHZfcGFjayhUTFZfVFlQRV9VVUlELCBiaW5hc2NpaS5hMmJfaGV4KFBBWUxPQURfVVVJRCkpCgkJCQkJCXBrdCArPSB0bHZfcGFjayhUTFZfVFlQRV9DSEFOTkVMX0lELCBjbGllbnRfY2hhbm5lbF9pZCkKCQkJCQkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX0NIQU5ORUxfUEFSRU5USUQsIGNoYW5uZWxfaWQpCgkJCQkJCXBrdCArPSB0bHZfcGFjayhUTFZfVFlQRV9MT0NBTF9IT1NULCBpbmV0X3B0b24oY2hhbm5lbC5mYW1pbHksIHNlcnZlcl9hZGRyWzBdKSkKCQkJCQkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX0xPQ0FMX1BPUlQsIHNlcnZlcl9hZGRyWzFdKQoJCQkJCQlwa3QgKz0gdGx2X3BhY2soVExWX1RZUEVfUEVFUl9IT1NULCBpbmV0X3B0b24oY2xpZW50X3NvY2suZmFtaWx5LCBjbGllbnRfYWRkclswXSkpCgkJCQkJCXBrdCArPSB0bHZfcGFjayhUTFZfVFlQRV9QRUVSX1BPUlQsIGNsaWVudF9hZGRyWzFdKQoJCQkJCQlwa3QgID0gc3RydWN0LnBhY2soJz5JJywgbGVuKHBrdCkgKyA0KSArIHBrdAoJCQkJCQlzZWxmLnNlbmRfcGFja2V0KHBrdCkKCQkJCWlmIGRhdGE6CgkJCQkJcGt0ICA9IHN0cnVjdC5wYWNrKCc+SScsIFBBQ0tFVF9UWVBFX1JFUVVFU1QpCgkJCQkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX01FVEhPRCwgJ2NvcmVfY2hhbm5lbF93cml0ZScpCgkJCQkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX1VVSUQsIGJpbmFzY2lpLmEyYl9oZXgoUEFZTE9BRF9VVUlEKSkKCQkJCQlwa3QgKz0gdGx2X3BhY2soVExWX1RZUEVfQ0hBTk5FTF9JRCwgY2hhbm5lbF9pZCkKCQkJCQlwa3QgKz0gdGx2X3BhY2soVExWX1RZUEVfQ0hBTk5FTF9EQVRBLCBkYXRhKQoJCQkJCXBrdCArPSB0bHZfcGFjayhUTFZfVFlQRV9MRU5HVEgsIGxlbihkYXRhKSkKCQkJCQlwa3QgKz0gdGx2X3BhY2soVExWX1RZUEVfUkVRVUVTVF9JRCwgZ2VuZXJhdGVfcmVxdWVzdF9pZCgpKQoJCQkJCXBrdCAgPSBzdHJ1Y3QucGFjaygnPkknLCBsZW4ocGt0KSArIDQpICsgcGt0CgkJCQkJc2VsZi5zZW5kX3BhY2tldChwa3QpCgoJZGVmIGhhbmRsZV9kZWFkX3Jlc291cmNlX2NoYW5uZWwoc2VsZiwgY2hhbm5lbF9pZCk6CgkJZGVsIHNlbGYuY2hhbm5lbHNbY2hhbm5lbF9pZF0KCQlpZiBjaGFubmVsX2lkIGluIHNlbGYuaW50ZXJhY3RfY2hhbm5lbHM6CgkJCXNlbGYuaW50ZXJhY3RfY2hhbm5lbHMucmVtb3ZlKGNoYW5uZWxfaWQpCgkJcGt0ICA9IHN0cnVjdC5wYWNrKCc+SScsIFBBQ0tFVF9UWVBFX1JFUVVFU1QpCgkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX01FVEhPRCwgJ2NvcmVfY2hhbm5lbF9jbG9zZScpCgkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX1VVSUQsIGJpbmFzY2lpLmEyYl9oZXgoUEFZTE9BRF9VVUlEKSkKCQlwa3QgKz0gdGx2X3BhY2soVExWX1RZUEVfUkVRVUVTVF9JRCwgZ2VuZXJhdGVfcmVxdWVzdF9pZCgpKQoJCXBrdCArPSB0bHZfcGFjayhUTFZfVFlQRV9DSEFOTkVMX0lELCBjaGFubmVsX2lkKQoJCXBrdCAgPSBzdHJ1Y3QucGFjaygnPkknLCBsZW4ocGt0KSArIDQpICsgcGt0CgkJc2VsZi5zZW5kX3BhY2tldChwa3QpCgoJZGVmIF9jb3JlX3NldF91dWlkKHNlbGYsIHJlcXVlc3QsIHJlc3BvbnNlKToKCQluZXdfdXVpZCA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX1VVSUQpCgkJaWYgbmV3X3V1aWQ6CgkJCVBBWUxPQURfVVVJRCA9IGJpbmFzY2lpLmIyYV9oZXgobmV3X3V1aWRbJ3ZhbHVlJ10pCgkJcmV0dXJuIEVSUk9SX1NVQ0NFU1MsIHJlc3BvbnNlCgoJZGVmIF9jb3JlX2VudW1leHRjbWQoc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCWV4dGVuc2lvbl9uYW1lID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfU1RSSU5HKVsndmFsdWUnXQoJCWZvciBmdW5jX25hbWUgaW4gc2VsZi5leHRlbnNpb25fZnVuY3Rpb25zLmtleXMoKToKCQkJaWYgZnVuY19uYW1lLnNwbGl0KCdfJywgMSlbMF0gPT0gZXh0ZW5zaW9uX25hbWU6CgkJCQlyZXNwb25zZSArPSB0bHZfcGFjayhUTFZfVFlQRV9TVFJJTkcsIGZ1bmNfbmFtZSkKCQlyZXR1cm4gRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UKCglkZWYgX2NvcmVfbWFjaGluZV9pZChzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJc2VyaWFsID0gJycKCQltYWNoaW5lX25hbWUgPSBwbGF0Zm9ybS51bmFtZSgpWzFdCgkJaWYgaGFzX3dpbmRsbDoKCQkJZnJvbSBjdHlwZXMgaW1wb3J0IHdpbnR5cGVzCgoJCQlrMzIgPSBjdHlwZXMud2luZGxsLmtlcm5lbDMyCgkJCXN5c19kaXIgPSBjdHlwZXMuY3JlYXRlX3VuaWNvZGVfYnVmZmVyKDI2MCkKCQkJaWYgbm90IGszMi5HZXRTeXN0ZW1EaXJlY3RvcnlXKGN0eXBlcy5ieXJlZihzeXNfZGlyKSwgMjYwKToKCQkJCXJldHVybiBFUlJPUl9GQUlMVVJFX1dJTkRPV1MKCgkJCXZvbF9idWYgPSBjdHlwZXMuY3JlYXRlX3VuaWNvZGVfYnVmZmVyKDI2MCkKCQkJZnNfYnVmID0gY3R5cGVzLmNyZWF0ZV91bmljb2RlX2J1ZmZlcigyNjApCgkJCXNlcmlhbF9udW0gPSB3aW50eXBlcy5EV09SRCgwKQoKCQkJaWYgbm90IGszMi5HZXRWb2x1bWVJbmZvcm1hdGlvblcoY3R5cGVzLmNfd2NoYXJfcChzeXNfZGlyLnZhbHVlWzozXSksCgkJCQkJdm9sX2J1ZiwgY3R5cGVzLnNpemVvZih2b2xfYnVmKSwgY3R5cGVzLmJ5cmVmKHNlcmlhbF9udW0pLCBOb25lLAoJCQkJCU5vbmUsIGZzX2J1ZiwgY3R5cGVzLnNpemVvZihmc19idWYpKToKCQkJCXJldHVybiBFUlJPUl9GQUlMVVJFX1dJTkRPV1MKCQkJc2VyaWFsX251bSA9IHNlcmlhbF9udW0udmFsdWUKCQkJc2VyaWFsID0gIiUwNHgiICUgKChzZXJpYWxfbnVtID4+IDE2KSAmIDB4ZmZmZikgKyAnLScgIiUwNHgiICUgKHNlcmlhbF9udW0gJiAweGZmZmYpCgkJZWxzZToKCQkJc2VyaWFsID0gZ2V0X2hkZF9sYWJlbCgpCgoJCXJlc3BvbnNlICs9IHRsdl9wYWNrKFRMVl9UWVBFX01BQ0hJTkVfSUQsICIlczolcyIgJSAoc2VyaWFsLCBtYWNoaW5lX25hbWUpKQoJCXJldHVybiBFUlJPUl9TVUNDRVNTLCByZXNwb25zZQoKCWRlZiBfY29yZV9uYXRpdmVfYXJjaChzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJcmVzcG9uc2UgKz0gdGx2X3BhY2soVExWX1RZUEVfU1RSSU5HLCBnZXRfbmF0aXZlX2FyY2goKSkKCQlyZXR1cm4gRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UKCglkZWYgX2NvcmVfcGF0Y2hfdXJsKHNlbGYsIHJlcXVlc3QsIHJlc3BvbnNlKToKCQlpZiBub3QgaXNpbnN0YW5jZShzZWxmLnRyYW5zcG9ydCwgSHR0cFRyYW5zcG9ydCk6CgkJCXJldHVybiBFUlJPUl9GQUlMVVJFLCByZXNwb25zZQoJCW5ld191cmlfcGF0aCA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX1RSQU5TX1VSTClbJ3ZhbHVlJ10KCQlpZiBub3Qgc2VsZi50cmFuc3BvcnQucGF0Y2hfdXJpX3BhdGgobmV3X3VyaV9wYXRoKToKCQkJcmV0dXJuIEVSUk9SX0ZBSUxVUkUsIHJlc3BvbnNlCgkJcmV0dXJuIEVSUk9SX1NVQ0NFU1MsIHJlc3BvbnNlCgoJZGVmIF9jb3JlX2xvYWRsaWIoc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCWRhdGFfdGx2ID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfREFUQSkKCQlpZiAoZGF0YV90bHZbJ3R5cGUnXSAmIFRMVl9NRVRBX1RZUEVfQ09NUFJFU1NFRCkgPT0gVExWX01FVEFfVFlQRV9DT01QUkVTU0VEOgoJCQlyZXR1cm4gRVJST1JfRkFJTFVSRSwgcmVzcG9uc2UKCgkJc2VsZi5sYXN0X3JlZ2lzdGVyZWRfZXh0ZW5zaW9uID0gTm9uZQoJCXN5bWJvbHNfZm9yX2V4dGVuc2lvbnMgPSB7J21ldGVycHJldGVyJzpzZWxmfQoJCXN5bWJvbHNfZm9yX2V4dGVuc2lvbnMudXBkYXRlKEVYUE9SVEVEX1NZTUJPTFMpCgkJaSA9IGNvZGUuSW50ZXJhY3RpdmVJbnRlcnByZXRlcihzeW1ib2xzX2Zvcl9leHRlbnNpb25zKQoJCWkucnVuY29kZShjb21waWxlKGRhdGFfdGx2Wyd2YWx1ZSddLCAnJywgJ2V4ZWMnKSkKCQlleHRlbnNpb25fbmFtZSA9IHNlbGYubGFzdF9yZWdpc3RlcmVkX2V4dGVuc2lvbgoKCQlpZiBleHRlbnNpb25fbmFtZToKCQkJY2hlY2tfZXh0ZW5zaW9uID0gbGFtYmRhIHg6IHguc3RhcnRzd2l0aChleHRlbnNpb25fbmFtZSkKCQkJbGliX21ldGhvZHMgPSBsaXN0KGZpbHRlcihjaGVja19leHRlbnNpb24sIGxpc3Qoc2VsZi5leHRlbnNpb25fZnVuY3Rpb25zLmtleXMoKSkpKQoJCQlmb3IgbWV0aG9kIGluIGxpYl9tZXRob2RzOgoJCQkJcmVzcG9uc2UgKz0gdGx2X3BhY2soVExWX1RZUEVfTUVUSE9ELCBtZXRob2QpCgkJcmV0dXJuIEVSUk9SX1NVQ0NFU1MsIHJlc3BvbnNlCgoJZGVmIF9jb3JlX3NodXRkb3duKHNlbGYsIHJlcXVlc3QsIHJlc3BvbnNlKToKCQlyZXNwb25zZSArPSB0bHZfcGFjayhUTFZfVFlQRV9CT09MLCBUcnVlKQoJCXNlbGYucnVubmluZyA9IEZhbHNlCgkJcmV0dXJuIEVSUk9SX1NVQ0NFU1MsIHJlc3BvbnNlCgoJZGVmIF9jb3JlX3RyYW5zcG9ydF9hZGQoc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCW5ld190cmFuc3BvcnQgPSBUcmFuc3BvcnQuZnJvbV9yZXF1ZXN0KHJlcXVlc3QpCgkJc2VsZi50cmFuc3BvcnRfYWRkKG5ld190cmFuc3BvcnQpCgkJcmV0dXJuIEVSUk9SX1NVQ0NFU1MsIHJlc3BvbnNlCgoJZGVmIF9jb3JlX3RyYW5zcG9ydF9jaGFuZ2Uoc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCW5ld190cmFuc3BvcnQgPSBUcmFuc3BvcnQuZnJvbV9yZXF1ZXN0KHJlcXVlc3QpCgkJc2VsZi50cmFuc3BvcnRfYWRkKG5ld190cmFuc3BvcnQpCgkJc2VsZi5zZW5kX3BhY2tldCh0bHZfcGFja19yZXNwb25zZShFUlJPUl9TVUNDRVNTLCByZXNwb25zZSkpCgkJc2VsZi50cmFuc3BvcnRfY2hhbmdlKG5ld190cmFuc3BvcnQpCgkJcmV0dXJuIE5vbmUKCglkZWYgX2NvcmVfdHJhbnNwb3J0X2xpc3Qoc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCWlmIHNlbGYuc2Vzc2lvbl9leHBpcnlfdGltZSA+IDA6CgkJCXJlc3BvbnNlICs9IHRsdl9wYWNrKFRMVl9UWVBFX1RSQU5TX1NFU1NJT05fRVhQLCBzZWxmLnNlc3Npb25fZXhwaXJ5X2VuZCAtIHRpbWUudGltZSgpKQoJCXJlc3BvbnNlICs9IHRsdl9wYWNrKFRMVl9UWVBFX1RSQU5TX0dST1VQLCBzZWxmLnRyYW5zcG9ydC50bHZfcGFja190cmFuc3BvcnRfZ3JvdXAoKSkKCgkJdHJhbnNwb3J0ID0gc2VsZi50cmFuc3BvcnRfbmV4dCgpCgkJd2hpbGUgdHJhbnNwb3J0ICE9IHNlbGYudHJhbnNwb3J0OgoJCQlyZXNwb25zZSArPSB0bHZfcGFjayhUTFZfVFlQRV9UUkFOU19HUk9VUCwgdHJhbnNwb3J0LnRsdl9wYWNrX3RyYW5zcG9ydF9ncm91cCgpKQoJCQl0cmFuc3BvcnQgPSBzZWxmLnRyYW5zcG9ydF9uZXh0KHRyYW5zcG9ydCkKCQlyZXR1cm4gRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UKCglkZWYgX2NvcmVfdHJhbnNwb3J0X25leHQoc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCW5ld190cmFuc3BvcnQgPSBzZWxmLnRyYW5zcG9ydF9uZXh0KCkKCQlpZiBuZXdfdHJhbnNwb3J0ID09IHNlbGYudHJhbnNwb3J0OgoJCQlyZXR1cm4gRVJST1JfRkFJTFVSRSwgcmVzcG9uc2UKCQlzZWxmLnNlbmRfcGFja2V0KHRsdl9wYWNrX3Jlc3BvbnNlKEVSUk9SX1NVQ0NFU1MsIHJlc3BvbnNlKSkKCQlzZWxmLnRyYW5zcG9ydF9jaGFuZ2UobmV3X3RyYW5zcG9ydCkKCQlyZXR1cm4gTm9uZQoKCWRlZiBfY29yZV90cmFuc3BvcnRfcHJldihzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJbmV3X3RyYW5zcG9ydCA9IHNlbGYudHJhbnNwb3J0X3ByZXYoKQoJCWlmIG5ld190cmFuc3BvcnQgPT0gc2VsZi50cmFuc3BvcnQ6CgkJCXJldHVybiBFUlJPUl9GQUlMVVJFLCByZXNwb25zZQoJCXNlbGYuc2VuZF9wYWNrZXQodGx2X3BhY2tfcmVzcG9uc2UoRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UpKQoJCXNlbGYudHJhbnNwb3J0X2NoYW5nZShuZXdfdHJhbnNwb3J0KQoJCXJldHVybiBOb25lCgoJZGVmIF9jb3JlX3RyYW5zcG9ydF9yZW1vdmUoc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCXVybCA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX1RSQU5TX1VSTClbJ3ZhbHVlJ10KCQlpZiBzZWxmLnRyYW5zcG9ydC51cmwgPT0gdXJsOgoJCQlyZXR1cm4gRVJST1JfRkFJTFVSRSwgcmVzcG9uc2UKCQl0cmFuc3BvcnRfZm91bmQgPSBGYWxzZQoJCWZvciB0cmFuc3BvcnQgaW4gc2VsZi50cmFuc3BvcnRzOgoJCQlpZiB0cmFuc3BvcnQudXJsID09IHVybDoKCQkJCXRyYW5zcG9ydF9mb3VuZCA9IFRydWUKCQkJCWJyZWFrCgkJaWYgdHJhbnNwb3J0X2ZvdW5kOgoJCQlzZWxmLnRyYW5zcG9ydHMucmVtb3ZlKHRyYW5zcG9ydCkKCQkJcmV0dXJuIEVSUk9SX1NVQ0NFU1MsIHJlc3BvbnNlCgkJcmV0dXJuIEVSUk9SX0ZBSUxVUkUsIHJlc3BvbnNlCgoJZGVmIF9jb3JlX3RyYW5zcG9ydF9zZXRfdGltZW91dHMoc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCXRpbWVvdXRfdmFsdWUgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9UUkFOU19TRVNTSU9OX0VYUCkuZ2V0KCd2YWx1ZScpCgkJaWYgbm90IHRpbWVvdXRfdmFsdWUgaXMgTm9uZToKCQkJc2VsZi5zZXNzaW9uX2V4cGlyeV90aW1lID0gdGltZW91dF92YWx1ZQoJCQlzZWxmLnNlc3Npb25fZXhwaXJ5X2VuZCA9IHRpbWUudGltZSgpICsgc2VsZi5zZXNzaW9uX2V4cGlyeV90aW1lCgkJdGltZW91dF92YWx1ZSA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX1RSQU5TX0NPTU1fVElNRU9VVCkuZ2V0KCd2YWx1ZScpCgkJaWYgdGltZW91dF92YWx1ZToKCQkJc2VsZi50cmFuc3BvcnQuY29tbXVuaWNhdGlvbl90aW1lb3V0ID0gdGltZW91dF92YWx1ZQoJCXJldHJ5X3ZhbHVlID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfVFJBTlNfUkVUUllfVE9UQUwpLmdldCgndmFsdWUnKQoJCWlmIHJldHJ5X3ZhbHVlOgoJCQlzZWxmLnRyYW5zcG9ydC5yZXRyeV90b3RhbCA9IHJldHJ5X3ZhbHVlCgkJcmV0cnlfdmFsdWUgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9UUkFOU19SRVRSWV9XQUlUKS5nZXQoJ3ZhbHVlJykKCQlpZiByZXRyeV92YWx1ZToKCQkJc2VsZi50cmFuc3BvcnQucmV0cnlfd2FpdCA9IHJldHJ5X3ZhbHVlCgoJCWlmIHNlbGYuc2Vzc2lvbl9leHBpcnlfdGltZSA+IDA6CgkJCXJlc3BvbnNlICs9IHRsdl9wYWNrKFRMVl9UWVBFX1RSQU5TX1NFU1NJT05fRVhQLCBzZWxmLnNlc3Npb25fZXhwaXJ5X2VuZCAtIHRpbWUudGltZSgpKQoJCXJlc3BvbnNlICs9IHNlbGYudHJhbnNwb3J0LnRsdl9wYWNrX3RpbWVvdXRzKCkKCQlyZXR1cm4gRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UKCglkZWYgX2NvcmVfdHJhbnNwb3J0X3NsZWVwKHNlbGYsIHJlcXVlc3QsIHJlc3BvbnNlKToKCQlzZWNvbmRzID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfVFJBTlNfQ09NTV9USU1FT1VUKVsndmFsdWUnXQoJCXNlbGYuc2VuZF9wYWNrZXQodGx2X3BhY2tfcmVzcG9uc2UoRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UpKQoJCWlmIHNlY29uZHM6CgkJCXNlbGYudHJhbnNwb3J0LmRlYWN0aXZhdGUoKQoJCQl0aW1lLnNsZWVwKHNlY29uZHMpCgkJCWlmIG5vdCBzZWxmLnRyYW5zcG9ydC5hY3RpdmF0ZSgpOgoJCQkJc2VsZi50cmFuc3BvcnRfY2hhbmdlKCkKCQlyZXR1cm4gTm9uZQoKCWRlZiBfY29yZV9jaGFubmVsX29wZW4oc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCWNoYW5uZWxfdHlwZSA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX0NIQU5ORUxfVFlQRSkKCQloYW5kbGVyID0gJ2NoYW5uZWxfb3Blbl8nICsgY2hhbm5lbF90eXBlWyd2YWx1ZSddCgkJaWYgaGFuZGxlciBub3QgaW4gc2VsZi5leHRlbnNpb25fZnVuY3Rpb25zOgoJCQlyZXR1cm4gZXJyb3JfcmVzdWx0KE5vdEltcGxlbWVudGVkRXJyb3IpLCByZXNwb25zZQoJCWhhbmRsZXIgPSBzZWxmLmV4dGVuc2lvbl9mdW5jdGlvbnNbaGFuZGxlcl0KCQlyZXR1cm4gaGFuZGxlcihyZXF1ZXN0LCByZXNwb25zZSkKCglkZWYgX2NvcmVfY2hhbm5lbF9jbG9zZShzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJY2hhbm5lbF9pZCA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX0NIQU5ORUxfSUQpWyd2YWx1ZSddCgkJaWYgY2hhbm5lbF9pZCBub3QgaW4gc2VsZi5jaGFubmVsczoKCQkJcmV0dXJuIEVSUk9SX0ZBSUxVUkUsIHJlc3BvbnNlCgkJY2hhbm5lbCA9IHNlbGYuY2hhbm5lbHNbY2hhbm5lbF9pZF0KCQlpZiBpc2luc3RhbmNlKGNoYW5uZWwsIHN1YnByb2Nlc3MuUG9wZW4pOgoJCQljaGFubmVsLmtpbGwoKQoJCWVsaWYgaXNpbnN0YW5jZShjaGFubmVsLCBNZXRlcnByZXRlckZpbGUpOgoJCQljaGFubmVsLmNsb3NlKCkKCQllbGlmIGlzaW5zdGFuY2UoY2hhbm5lbCwgTWV0ZXJwcmV0ZXJTb2NrZXQpOgoJCQljaGFubmVsLmNsb3NlKCkKCQllbHNlOgoJCQlyZXR1cm4gRVJST1JfRkFJTFVSRSwgcmVzcG9uc2UKCQlkZWwgc2VsZi5jaGFubmVsc1tjaGFubmVsX2lkXQoJCWlmIGNoYW5uZWxfaWQgaW4gc2VsZi5pbnRlcmFjdF9jaGFubmVsczoKCQkJc2VsZi5pbnRlcmFjdF9jaGFubmVscy5yZW1vdmUoY2hhbm5lbF9pZCkKCQlkZWJ1Z19wcmludCgnWypdIGNsb3NlZCBhbmQgcmVtb3ZlZCBjaGFubmVsIGlkOiAnICsgc3RyKGNoYW5uZWxfaWQpKQoJCXJldHVybiBFUlJPUl9TVUNDRVNTLCByZXNwb25zZQoKCWRlZiBfY29yZV9jaGFubmVsX2VvZihzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJY2hhbm5lbF9pZCA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX0NIQU5ORUxfSUQpWyd2YWx1ZSddCgkJaWYgY2hhbm5lbF9pZCBub3QgaW4gc2VsZi5jaGFubmVsczoKCQkJcmV0dXJuIEVSUk9SX0ZBSUxVUkUsIHJlc3BvbnNlCgkJY2hhbm5lbCA9IHNlbGYuY2hhbm5lbHNbY2hhbm5lbF9pZF0KCQlyZXN1bHQgPSBGYWxzZQoJCWlmIGlzaW5zdGFuY2UoY2hhbm5lbCwgTWV0ZXJwcmV0ZXJGaWxlKToKCQkJcmVzdWx0ID0gY2hhbm5lbC50ZWxsKCkgPj0gb3MuZnN0YXQoY2hhbm5lbC5maWxlbm8oKSkuc3Rfc2l6ZQoJCXJlc3BvbnNlICs9IHRsdl9wYWNrKFRMVl9UWVBFX0JPT0wsIHJlc3VsdCkKCQlyZXR1cm4gRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UKCglkZWYgX2NvcmVfY2hhbm5lbF9pbnRlcmFjdChzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJY2hhbm5lbF9pZCA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX0NIQU5ORUxfSUQpWyd2YWx1ZSddCgkJaWYgY2hhbm5lbF9pZCBub3QgaW4gc2VsZi5jaGFubmVsczoKCQkJcmV0dXJuIEVSUk9SX0ZBSUxVUkUsIHJlc3BvbnNlCgkJY2hhbm5lbCA9IHNlbGYuY2hhbm5lbHNbY2hhbm5lbF9pZF0KCQl0b2dnbGUgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9CT09MKVsndmFsdWUnXQoJCWlmIHRvZ2dsZToKCQkJaWYgY2hhbm5lbF9pZCBpbiBzZWxmLmludGVyYWN0X2NoYW5uZWxzOgoJCQkJc2VsZi5pbnRlcmFjdF9jaGFubmVscy5yZW1vdmUoY2hhbm5lbF9pZCkKCQkJZWxzZToKCQkJCXNlbGYuaW50ZXJhY3RfY2hhbm5lbHMuYXBwZW5kKGNoYW5uZWxfaWQpCgkJZWxpZiBjaGFubmVsX2lkIGluIHNlbGYuaW50ZXJhY3RfY2hhbm5lbHM6CgkJCXNlbGYuaW50ZXJhY3RfY2hhbm5lbHMucmVtb3ZlKGNoYW5uZWxfaWQpCgkJcmV0dXJuIEVSUk9SX1NVQ0NFU1MsIHJlc3BvbnNlCgoJZGVmIF9jb3JlX2NoYW5uZWxfcmVhZChzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJY2hhbm5lbF9pZCA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX0NIQU5ORUxfSUQpWyd2YWx1ZSddCgkJbGVuZ3RoID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfTEVOR1RIKVsndmFsdWUnXQoJCWlmIGNoYW5uZWxfaWQgbm90IGluIHNlbGYuY2hhbm5lbHM6CgkJCXJldHVybiBFUlJPUl9GQUlMVVJFLCByZXNwb25zZQoJCWNoYW5uZWwgPSBzZWxmLmNoYW5uZWxzW2NoYW5uZWxfaWRdCgkJZGF0YSA9ICcnCgkJaWYgaXNpbnN0YW5jZShjaGFubmVsLCBTVERQcm9jZXNzKToKCQkJaWYgY2hhbm5lbC5wb2xsKCkgIT0gTm9uZToKCQkJCXNlbGYuaGFuZGxlX2RlYWRfcmVzb3VyY2VfY2hhbm5lbChjaGFubmVsX2lkKQoJCQlpZiBjaGFubmVsLnN0ZG91dF9yZWFkZXIuaXNfcmVhZF9yZWFkeSgpOgoJCQkJZGF0YSA9IGNoYW5uZWwuc3Rkb3V0X3JlYWRlci5yZWFkKGxlbmd0aCkKCQllbGlmIGlzaW5zdGFuY2UoY2hhbm5lbCwgTWV0ZXJwcmV0ZXJGaWxlKToKCQkJZGF0YSA9IGNoYW5uZWwucmVhZChsZW5ndGgpCgkJZWxpZiBpc2luc3RhbmNlKGNoYW5uZWwsIE1ldGVycHJldGVyU29ja2V0KToKCQkJZGF0YSA9IGNoYW5uZWwucmVjdihsZW5ndGgpCgkJZWxzZToKCQkJcmV0dXJuIEVSUk9SX0ZBSUxVUkUsIHJlc3BvbnNlCgkJcmVzcG9uc2UgKz0gdGx2X3BhY2soVExWX1RZUEVfQ0hBTk5FTF9EQVRBLCBkYXRhKQoJCXJldHVybiBFUlJPUl9TVUNDRVNTLCByZXNwb25zZQoKCWRlZiBfY29yZV9jaGFubmVsX3dyaXRlKHNlbGYsIHJlcXVlc3QsIHJlc3BvbnNlKToKCQljaGFubmVsX2lkID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfQ0hBTk5FTF9JRClbJ3ZhbHVlJ10KCQljaGFubmVsX2RhdGEgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9DSEFOTkVMX0RBVEEpWyd2YWx1ZSddCgkJbGVuZ3RoID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfTEVOR1RIKVsndmFsdWUnXQoJCWlmIGNoYW5uZWxfaWQgbm90IGluIHNlbGYuY2hhbm5lbHM6CgkJCXJldHVybiBFUlJPUl9GQUlMVVJFLCByZXNwb25zZQoJCWNoYW5uZWwgPSBzZWxmLmNoYW5uZWxzW2NoYW5uZWxfaWRdCgkJbCA9IGxlbihjaGFubmVsX2RhdGEpCgkJaWYgaXNpbnN0YW5jZShjaGFubmVsLCBzdWJwcm9jZXNzLlBvcGVuKToKCQkJaWYgY2hhbm5lbC5wb2xsKCkgIT0gTm9uZToKCQkJCXNlbGYuaGFuZGxlX2RlYWRfcmVzb3VyY2VfY2hhbm5lbChjaGFubmVsX2lkKQoJCQkJcmV0dXJuIEVSUk9SX0ZBSUxVUkUsIHJlc3BvbnNlCgkJCWNoYW5uZWwud3JpdGUoY2hhbm5lbF9kYXRhKQoJCWVsaWYgaXNpbnN0YW5jZShjaGFubmVsLCBNZXRlcnByZXRlckZpbGUpOgoJCQljaGFubmVsLndyaXRlKGNoYW5uZWxfZGF0YSkKCQllbGlmIGlzaW5zdGFuY2UoY2hhbm5lbCwgTWV0ZXJwcmV0ZXJTb2NrZXQpOgoJCQl0cnk6CgkJCQlsID0gY2hhbm5lbC5zZW5kKGNoYW5uZWxfZGF0YSkKCQkJZXhjZXB0IHNvY2tldC5lcnJvcjoKCQkJCWNoYW5uZWwuY2xvc2UoKQoJCQkJc2VsZi5oYW5kbGVfZGVhZF9yZXNvdXJjZV9jaGFubmVsKGNoYW5uZWxfaWQpCgkJCQlyZXR1cm4gRVJST1JfRkFJTFVSRSwgcmVzcG9uc2UKCQllbHNlOgoJCQlyZXR1cm4gRVJST1JfRkFJTFVSRSwgcmVzcG9uc2UKCQlyZXNwb25zZSArPSB0bHZfcGFjayhUTFZfVFlQRV9MRU5HVEgsIGwpCgkJcmV0dXJuIEVSUk9SX1NVQ0NFU1MsIHJlc3BvbnNlCgoJZGVmIGNyZWF0ZV9yZXNwb25zZShzZWxmLCByZXF1ZXN0KToKCQlyZXNwID0gc3RydWN0LnBhY2soJz5JJywgUEFDS0VUX1RZUEVfUkVTUE9OU0UpCgkJbWV0aG9kX3RsdiA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX01FVEhPRCkKCQlyZXNwICs9IHRsdl9wYWNrKG1ldGhvZF90bHYpCgkJcmVzcCArPSB0bHZfcGFjayhUTFZfVFlQRV9VVUlELCBiaW5hc2NpaS5hMmJfaGV4KFBBWUxPQURfVVVJRCkpCgoJCWhhbmRsZXJfbmFtZSA9IG1ldGhvZF90bHZbJ3ZhbHVlJ10KCQlpZiBoYW5kbGVyX25hbWUgaW4gc2VsZi5leHRlbnNpb25fZnVuY3Rpb25zOgoJCQloYW5kbGVyID0gc2VsZi5leHRlbnNpb25fZnVuY3Rpb25zW2hhbmRsZXJfbmFtZV0KCQkJdHJ5OgoJCQkJZGVidWdfcHJpbnQoJ1sqXSBydW5uaW5nIG1ldGhvZCAnICsgaGFuZGxlcl9uYW1lKQoJCQkJcmVzdWx0ID0gaGFuZGxlcihyZXF1ZXN0LCByZXNwKQoJCQkJaWYgcmVzdWx0IGlzIE5vbmU6CgkJCQkJcmV0dXJuCgkJCQlyZXN1bHQsIHJlc3AgPSByZXN1bHQKCQkJZXhjZXB0IEV4Y2VwdGlvbjoKCQkJCWRlYnVnX3ByaW50KCdbLV0gbWV0aG9kICcgKyBoYW5kbGVyX25hbWUgKyAnIHJlc3VsdGVkIGluIGFuIGVycm9yJykKCQkJCWlmIERFQlVHR0lORzoKCQkJCQl0cmFjZWJhY2sucHJpbnRfZXhjKGZpbGU9c3lzLnN0ZGVycikKCQkJCXJlc3VsdCA9IGVycm9yX3Jlc3VsdCgpCgkJCWVsc2U6CgkJCQlpZiByZXN1bHQgIT0gRVJST1JfU1VDQ0VTUzoKCQkJCQlkZWJ1Z19wcmludCgnWy1dIG1ldGhvZCAnICsgaGFuZGxlcl9uYW1lICsgJyByZXN1bHRlZCBpbiBlcnJvcjogIycgKyBzdHIocmVzdWx0KSkKCQllbHNlOgoJCQlkZWJ1Z19wcmludCgnWy1dIG1ldGhvZCAnICsgaGFuZGxlcl9uYW1lICsgJyB3YXMgcmVxdWVzdGVkIGJ1dCBkb2VzIG5vdCBleGlzdCcpCgkJCXJlc3VsdCA9IGVycm9yX3Jlc3VsdChOb3RJbXBsZW1lbnRlZEVycm9yKQoKCQlyZXFpZF90bHYgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9SRVFVRVNUX0lEKQoJCWlmIG5vdCByZXFpZF90bHY6CgkJCXJldHVybgoJCXJlc3AgKz0gdGx2X3BhY2socmVxaWRfdGx2KQoJCXJldHVybiB0bHZfcGFja19yZXNwb25zZShyZXN1bHQsIHJlc3ApCgppZiBub3QgaGFzYXR0cihvcywgJ2ZvcmsnKSBvciAoaGFzYXR0cihvcywgJ2ZvcmsnKSBhbmQgb3MuZm9yaygpID09IDApOgoJaWYgaGFzYXR0cihvcywgJ3NldHNpZCcpOgoJCXRyeToKCQkJb3Muc2V0c2lkKCkKCQlleGNlcHQgT1NFcnJvcjoKCQkJcGFzcwoJaWYgSFRUUF9DT05ORUNUSU9OX1VSTCBhbmQgaGFzX3VybGxpYjoKCQl0cmFuc3BvcnQgPSBIdHRwVHJhbnNwb3J0KEhUVFBfQ09OTkVDVElPTl9VUkwsIHByb3h5PUhUVFBfUFJPWFksIHVzZXJfYWdlbnQ9SFRUUF9VU0VSX0FHRU5UKQoJZWxzZToKCQkjIFBBVENILVNFVFVQLVNUQUdFTEVTUy1UQ1AtU09DS0VUICMKCQl0cmFuc3BvcnQgPSBUY3BUcmFuc3BvcnQuZnJvbV9zb2NrZXQocykKCW1ldCA9IFB5dGhvbk1ldGVycHJldGVyKHRyYW5zcG9ydCkKCSMgUEFUQ0gtU0VUVVAtVFJBTlNQT1JUUyAjCgltZXQucnVuKCkK')))